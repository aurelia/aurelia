# AUR0764: Node Not Part of an Aurelia App DOM Tree

## Error Message

`AUR0764: Trying to retrieve a custom element controller from a node. But the provided node <{{nodeName}} /> does not appear to be part of an Aurelia app DOM tree, or it was added to the DOM in a way that Aurelia cannot properly resolve its position in the component tree.`

Where `{{nodeName}}` is the tag name of the provided DOM node.

## Description

This error occurs when Aurelia tries to locate the nearest owning custom element controller for a DOM node by walking up the DOM tree, but the walk does not encounter an Aurelia component boundary. This usually means the node is outside the DOM tree managed by the Aurelia app (or was inserted in a way that bypassed Aurelia).

## Example Trigger

```ts
import { CustomElement } from '@aurelia/runtime-html';

// ❌ Node created/added outside Aurelia control
const external = document.createElement('div');
document.body.appendChild(external);

CustomElement.findController(external); // throws AUR0764
```

## Correct Usage

- Only call controller lookup APIs for nodes that are part of the Aurelia app’s rendered DOM.
- Avoid manipulating Aurelia-managed DOM with `innerHTML` / manual `appendChild` if you need controller association.

## Troubleshooting

- Confirm the node is a descendant of the element you started Aurelia on.
- If the node is dynamically created, create it through Aurelia composition/rendering APIs rather than direct DOM manipulation.
- If using Shadow DOM, ensure you query within the correct shadow root context.

## Related Errors

- [AUR0765](aur0765.md)
- [AUR0762](aur0762.md)
- [AUR0763](aur0763.md)

