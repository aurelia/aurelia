{"version":3,"file":"index.umd.js","sources":["../src/util.ts","../src/retry-interceptor.ts","../src/http-client-configuration.ts","../src/http-client.ts"],"sourcesContent":["/**\n * Serialize an object to JSON. Useful for easily creating JSON fetch request bodies.\n *\n * @param body The object to be serialized to JSON.\n * @param replacer The JSON.stringify replacer used when serializing.\n * @returns A JSON string.\n */\nexport function json(body: unknown, replacer?: (key: string, value: unknown) => unknown): string {\n  return JSON.stringify((body !== undefined ? body : {}), replacer);\n}\n","import { ITimerHandler, PLATFORM } from '@aurelia/kernel';\nimport { HttpClient } from './http-client';\nimport { Interceptor, RetryableRequest, RetryConfiguration } from './interfaces';\n\nexport const retryStrategy: {\n  fixed: 0;\n  incremental: 1;\n  exponential: 2;\n  random: 3;\n} = {\n  fixed: 0,\n  incremental: 1,\n  exponential: 2,\n  random: 3\n};\n\nconst defaultRetryConfig: RetryConfiguration = {\n  maxRetries: 3,\n  interval: 1000,\n  strategy: retryStrategy.fixed\n};\n\n/**\n * Interceptor that retries requests on error, based on a given RetryConfiguration.\n */\nexport class RetryInterceptor implements Interceptor {\n  public retryConfig: RetryConfiguration;\n\n  /**\n   * Creates an instance of RetryInterceptor.\n   */\n  constructor(retryConfig?: RetryConfiguration) {\n    this.retryConfig = {...defaultRetryConfig, ...(retryConfig !== undefined ? retryConfig : {})};\n\n    if (this.retryConfig.strategy === retryStrategy.exponential &&\n      (this.retryConfig.interval as number) <= 1000) {\n      throw new Error('An interval less than or equal to 1 second is not allowed when using the exponential retry strategy');\n    }\n  }\n\n  /**\n   * Called with the request before it is sent. It remembers the request so it can be retried on error.\n   *\n   * @param request The request to be sent.\n   * @returns The existing request, a new request or a response; or a Promise for any of these.\n   */\n  public request(request: RetryableRequest): RetryableRequest {\n    if (!request.retryConfig) {\n      request.retryConfig = {...this.retryConfig};\n      request.retryConfig.counter = 0;\n    }\n\n    // do this on every request\n    request.retryConfig.requestClone = request.clone();\n\n    return request;\n  }\n\n  /**\n   * Called with the response after it is received. Clears the remembered request, as it was succesfull.\n   *\n   * @param response The response.\n   * @returns The response; or a Promise for one.\n   */\n  public response(response: Response, request: RetryableRequest): Response {\n    // retry was successful, so clean up after ourselves\n    Reflect.deleteProperty(request, 'retryConfig');\n    return response;\n  }\n\n  /**\n   * Handles fetch errors and errors generated by previous interceptors. This\n   * function acts as a Promise rejection handler. It wil retry the remembered request based on the\n   * configured RetryConfiguration.\n   *\n   * @param error The rejection value from the fetch request or from a\n   * previous interceptor.\n   * @returns The response of the retry; or a Promise for one.\n   */\n\n  public responseError(error: Response, request: RetryableRequest, httpClient: HttpClient): Response | Promise<Response> {\n    const { retryConfig } = request as { retryConfig: Required<RetryConfiguration> };\n    const { requestClone } = retryConfig;\n    return Promise.resolve().then(() => {\n      if (retryConfig.counter < retryConfig.maxRetries) {\n        const result = retryConfig.doRetry !== undefined ? retryConfig.doRetry(error, request) : true;\n\n        return Promise.resolve(result).then(doRetry => {\n          if (doRetry) {\n            retryConfig.counter++;\n            const delay = calculateDelay(retryConfig);\n            // tslint:disable-next-line:no-string-based-set-timeout\n            return new Promise((resolve: ITimerHandler) => PLATFORM.global.setTimeout(resolve, !isNaN(delay) ? delay : 0))\n              .then(() => {\n                const newRequest = requestClone.clone();\n                if (typeof (retryConfig.beforeRetry) === 'function') {\n                  return retryConfig.beforeRetry(newRequest, httpClient);\n                }\n                return newRequest;\n              })\n              .then(newRequest => {\n                const retryableRequest: RetryableRequest = {...newRequest, retryConfig};\n                return httpClient.fetch(retryableRequest);\n              });\n          }\n\n          // no more retries, so clean up\n          Reflect.deleteProperty(request, 'retryConfig');\n          throw error;\n        });\n      }\n      // no more retries, so clean up\n      Reflect.deleteProperty(request, 'retryConfig');\n      throw error;\n    });\n  }\n}\n\nfunction calculateDelay(retryConfig: RetryConfiguration): number {\n  const { interval, strategy, minRandomInterval, maxRandomInterval, counter } = retryConfig as Required<RetryConfiguration>;\n\n  if (typeof (strategy) === 'function') {\n    return (retryConfig.strategy as (retryCount: number) => number)(counter);\n  }\n\n  switch (strategy) {\n    case (retryStrategy.fixed):\n      return retryStrategies[retryStrategy.fixed](interval);\n    case (retryStrategy.incremental):\n      return retryStrategies[retryStrategy.incremental](counter, interval);\n    case (retryStrategy.exponential):\n      return retryStrategies[retryStrategy.exponential](counter, interval);\n    case (retryStrategy.random):\n      return retryStrategies[retryStrategy.random](counter, interval, minRandomInterval, maxRandomInterval);\n    default:\n      throw new Error('Unrecognized retry strategy');\n  }\n}\n\nconst retryStrategies = [\n  // fixed\n  interval => interval,\n\n  // incremental\n  (retryCount, interval) => interval * retryCount,\n\n  // exponential\n  (retryCount, interval) => retryCount === 1 ? interval : Math.pow(interval, retryCount) / 1000,\n\n  // random\n  (retryCount, interval, minRandomInterval = 0, maxRandomInterval = 60000) => {\n    // tslint:disable-next-line:insecure-random\n    return Math.random() * (maxRandomInterval - minRandomInterval) + minRandomInterval;\n  }\n] as [\n    (interval: number) => number,\n    (retryCount: number, interval: number) => number,\n    (retryCount: number, interval: number) => number,\n    (retryCount: number, interval: number, minRandomInterval?: number, maxRandomInterval?: number) => number\n  ];\n","import { Interceptor, RetryConfiguration } from './interfaces';\nimport { RetryInterceptor } from './retry-interceptor';\n\n/**\n * A class for configuring HttpClients.\n */\nexport class HttpClientConfiguration {\n  /**\n   * The base URL to be prepended to each Request's url before sending.\n   */\n  public baseUrl: string = '';\n\n  /**\n   * Default values to apply to init objects when creating Requests. Note that\n   * defaults cannot be applied when Request objects are manually created because\n   * Request provides its own defaults and discards the original init object.\n   * See also https://developer.mozilla.org/en-US/docs/Web/API/Request/Request\n   */\n  public defaults: RequestInit = {};\n\n  /**\n   * Interceptors to be added to the HttpClient.\n   */\n  public interceptors: Interceptor[] = [];\n\n  /**\n   * Sets the baseUrl.\n   *\n   * @param baseUrl The base URL.\n   * @returns The chainable instance of this configuration object.\n   * @chainable\n   */\n  public withBaseUrl(baseUrl: string): HttpClientConfiguration {\n    this.baseUrl = baseUrl;\n    return this;\n  }\n\n  /**\n   * Sets the defaults.\n   *\n   * @param defaults The defaults.\n   * @returns The chainable instance of this configuration object.\n   * @chainable\n   */\n  public withDefaults(defaults: RequestInit): HttpClientConfiguration {\n    this.defaults = defaults;\n    return this;\n  }\n\n  /**\n   * Adds an interceptor to be run on all requests or responses.\n   *\n   * @param interceptor An object with request, requestError,\n   * response, or responseError methods. request and requestError act as\n   * resolve and reject handlers for the Request before it is sent.\n   * response and responseError act as resolve and reject handlers for\n   * the Response after it has been received.\n   * @returns The chainable instance of this configuration object.\n   * @chainable\n   */\n  public withInterceptor(interceptor: Interceptor): HttpClientConfiguration {\n    this.interceptors.push(interceptor);\n    return this;\n  }\n\n  /**\n   * Applies a configuration that addresses common application needs, including\n   * configuring same-origin credentials, and using rejectErrorResponses.\n   * @returns The chainable instance of this configuration object.\n   * @chainable\n   */\n  public useStandardConfiguration(): HttpClientConfiguration {\n    const standardConfig = { credentials: 'same-origin' };\n    Object.assign(this.defaults, standardConfig, this.defaults);\n    return this.rejectErrorResponses();\n  }\n\n  /**\n   * Causes Responses whose status codes fall outside the range 200-299 to reject.\n   * The fetch API only rejects on network errors or other conditions that prevent\n   * the request from completing, meaning consumers must inspect Response.ok in the\n   * Promise continuation to determine if the server responded with a success code.\n   * This method adds a response interceptor that causes Responses with error codes\n   * to be rejected, which is common behavior in HTTP client libraries.\n   * @returns The chainable instance of this configuration object.\n   * @chainable\n   */\n  public rejectErrorResponses(): HttpClientConfiguration {\n    return this.withInterceptor({ response: rejectOnError });\n  }\n\n  public withRetry(config?: RetryConfiguration): HttpClientConfiguration {\n    const interceptor: Interceptor = new RetryInterceptor(config);\n\n    return this.withInterceptor(interceptor);\n  }\n}\n\nfunction rejectOnError(response: Response): Response {\n  if (!response.ok) {\n    throw response;\n  }\n\n  return response;\n}\n","import { Key, PLATFORM, IIndexable } from '@aurelia/kernel';\nimport { DOM, IDOM } from '@aurelia/runtime';\nimport { HTMLDOM } from '@aurelia/runtime-html';\nimport { HttpClientConfiguration } from './http-client-configuration';\nimport { Interceptor, ValidInterceptorMethodName } from './interfaces';\nimport { RetryInterceptor } from './retry-interceptor';\n\nconst absoluteUrlRegexp = /^([a-z][a-z0-9+\\-.]*:)?\\/\\//i;\n\n/**\n * An HTTP client based on the Fetch API.\n */\nexport class HttpClient {\n  public static readonly inject: readonly Key[] = [IDOM];\n\n  /**\n   * The current number of active requests.\n   * Requests being processed by interceptors are considered active.\n   */\n  public activeRequestCount: number;\n\n  /**\n   * Indicates whether or not the client is currently making one or more requests.\n   */\n  public isRequesting: boolean;\n\n  /**\n   * Indicates whether or not the client has been configured.\n   */\n  public isConfigured: boolean;\n\n  /**\n   * The base URL set by the config.\n   */\n  public baseUrl: string;\n\n  /**\n   * The default request init to merge with values specified at request time.\n   */\n  public defaults: RequestInit | null;\n\n  /**\n   * The interceptors to be run during requests.\n   */\n  public interceptors: Interceptor[];\n\n  private readonly dom: HTMLDOM;\n  /**\n   * Creates an instance of HttpClient.\n   */\n  constructor(dom: HTMLDOM) {\n    if (dom.window.fetch === undefined) {\n      // tslint:disable-next-line:max-line-length\n      throw new Error('HttpClient requires a Fetch API implementation, but the current environment doesn\\'t support it. You may need to load a polyfill such as https://github.com/github/fetch');\n    }\n    this.dom = dom;\n    this.activeRequestCount = 0;\n    this.isRequesting = false;\n    this.isConfigured = false;\n    this.baseUrl = '';\n    this.defaults = null;\n    this.interceptors = [];\n  }\n\n  /**\n   * Configure this client with default settings to be used by all requests.\n   *\n   * @param config A configuration object, or a function that takes a config\n   * object and configures it.\n   * @returns The chainable instance of this HttpClient.\n   * @chainable\n   */\n  public configure(config: RequestInit | ((config: HttpClientConfiguration) => HttpClientConfiguration) | HttpClientConfiguration): HttpClient {\n\n    let normalizedConfig: HttpClientConfiguration;\n\n    if (typeof config === 'object') {\n      const requestInitConfiguration = { defaults: config as RequestInit };\n      normalizedConfig = requestInitConfiguration as HttpClientConfiguration;\n    } else if (typeof config === 'function') {\n      normalizedConfig = new HttpClientConfiguration();\n      normalizedConfig.baseUrl = this.baseUrl;\n      normalizedConfig.defaults = { ...this.defaults };\n      normalizedConfig.interceptors = this.interceptors;\n\n      const c = config(normalizedConfig);\n      if (HttpClientConfiguration.prototype.isPrototypeOf(c)) {\n        normalizedConfig = c;\n      }\n    } else {\n      throw new Error('invalid config');\n    }\n\n    const defaults = normalizedConfig.defaults;\n    if (defaults !== undefined && Headers.prototype.isPrototypeOf(defaults.headers as HeadersInit)) {\n      // Headers instances are not iterable in all browsers. Require a plain\n      // object here to allow default headers to be merged into request headers.\n      throw new Error('Default headers must be a plain object.');\n    }\n\n    const interceptors = normalizedConfig.interceptors;\n\n    if (interceptors !== undefined && interceptors.length) {\n      // find if there is a RetryInterceptor\n      if (interceptors.filter(x => RetryInterceptor.prototype.isPrototypeOf(x)).length > 1) {\n        throw new Error('Only one RetryInterceptor is allowed.');\n      }\n\n      const retryInterceptorIndex = interceptors.findIndex(x => RetryInterceptor.prototype.isPrototypeOf(x));\n\n      if (retryInterceptorIndex >= 0 && retryInterceptorIndex !== interceptors.length - 1) {\n        throw new Error('The retry interceptor must be the last interceptor defined.');\n      }\n    }\n\n    this.baseUrl = normalizedConfig.baseUrl;\n    this.defaults = defaults;\n    this.interceptors = normalizedConfig.interceptors !== undefined ? normalizedConfig.interceptors : [];\n    this.isConfigured = true;\n\n    return this;\n  }\n\n  /**\n   * Starts the process of fetching a resource. Default configuration parameters\n   * will be applied to the Request. The constructed Request will be passed to\n   * registered request interceptors before being sent. The Response will be passed\n   * to registered Response interceptors before it is returned.\n   *\n   * See also https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API\n   *\n   * @param input The resource that you wish to fetch. Either a\n   * Request object, or a string containing the URL of the resource.\n   * @param init An options object containing settings to be applied to\n   * the Request.\n   * @returns A Promise for the Response from the fetch request.\n   */\n  public fetch(input: Request | string, init?: RequestInit): Promise<Response> {\n    this.trackRequestStart();\n\n    let request = this.buildRequest(input, init);\n    return this.processRequest(request, this.interceptors).then(result => {\n      let response: Promise<Response>;\n\n      if (Response.prototype.isPrototypeOf(result)) {\n        response = Promise.resolve(result as Response);\n      } else if (Request.prototype.isPrototypeOf(result)) {\n        request = result as Request;\n        response = fetch(request);\n      } else {\n        throw new Error(`An invalid result was returned by the interceptor chain. Expected a Request or Response instance, but got [${result}]`);\n      }\n\n      return this.processResponse(response, this.interceptors, request);\n    })\n      .then(result => {\n        if (Request.prototype.isPrototypeOf(result)) {\n          return this.fetch(result as Request);\n        }\n        return result as Response;\n      })\n      .then(\n        result => {\n          this.trackRequestEnd();\n          return result;\n        },\n        error => {\n          this.trackRequestEnd();\n          throw error;\n        }\n      );\n  }\n\n  public buildRequest(input: string | Request, init: RequestInit | undefined): Request {\n    const defaults = this.defaults !== null ? this.defaults : {};\n    let request: Request;\n    let body: unknown;\n    let requestContentType: string | null;\n\n    const parsedDefaultHeaders = parseHeaderValues(defaults.headers as IIndexable);\n    if (Request.prototype.isPrototypeOf(input)) {\n      request = input as Request;\n      requestContentType = new Headers(request.headers).get('Content-Type');\n    } else {\n      if (!init) {\n        init = {};\n      }\n      body = init.body;\n      const bodyObj = body !== undefined ? { body: body as BodyInit } : null;\n      const requestInit: RequestInit = { ...defaults, headers: {}, ...init, ...bodyObj };\n      requestContentType = new Headers(requestInit.headers as Headers).get('Content-Type');\n      request = new Request(getRequestUrl(this.baseUrl, input as string), requestInit);\n    }\n    if (!requestContentType) {\n      if (new Headers(parsedDefaultHeaders).has('content-type')) {\n        request.headers.set('Content-Type', new Headers(parsedDefaultHeaders).get('content-type') as string);\n      } else if (body !== undefined && isJSON(body)) {\n        request.headers.set('Content-Type', 'application/json');\n      }\n    }\n    setDefaultHeaders(request.headers, parsedDefaultHeaders);\n    if (body !== undefined && Blob.prototype.isPrototypeOf(body as Blob) && (body as Blob).type) {\n      // work around bug in IE & Edge where the Blob type is ignored in the request\n      // https://connect.microsoft.com/IE/feedback/details/2136163\n      request.headers.set('Content-Type', (body as Blob).type);\n    }\n    return request;\n  }\n\n  /**\n   * Calls fetch as a GET request.\n   *\n   * @param input The resource that you wish to fetch. Either a\n   * Request object, or a string containing the URL of the resource.\n   * @param init An options object containing settings to be applied to\n   * the Request.\n   * @returns A Promise for the Response from the fetch request.\n   */\n  public get(input: Request | string, init?: RequestInit): Promise<Response> {\n    return this.fetch(input, init);\n  }\n\n  /**\n   * Calls fetch with request method set to POST.\n   *\n   * @param input The resource that you wish to fetch. Either a\n   * Request object, or a string containing the URL of the resource.\n   * @param body The body of the request.\n   * @param init An options object containing settings to be applied to\n   * the Request.\n   * @returns A Promise for the Response from the fetch request.\n   */\n  public post(input: Request | string, body?: BodyInit, init?: RequestInit): Promise<Response> {\n    return this.callFetch(input, body, init, 'POST');\n  }\n\n  /**\n   * Calls fetch with request method set to PUT.\n   *\n   * @param input The resource that you wish to fetch. Either a\n   * Request object, or a string containing the URL of the resource.\n   * @param body The body of the request.\n   * @param init An options object containing settings to be applied to\n   * the Request.\n   * @returns A Promise for the Response from the fetch request.\n   */\n  public put(input: Request | string, body?: BodyInit, init?: RequestInit): Promise<Response> {\n    return this.callFetch(input, body, init, 'PUT');\n  }\n\n  /**\n   * Calls fetch with request method set to PATCH.\n   *\n   * @param input The resource that you wish to fetch. Either a\n   * Request object, or a string containing the URL of the resource.\n   * @param body The body of the request.\n   * @param init An options object containing settings to be applied to\n   * the Request.\n   * @returns A Promise for the Response from the fetch request.\n   */\n  public patch(input: Request | string, body?: BodyInit, init?: RequestInit): Promise<Response> {\n    return this.callFetch(input, body, init, 'PATCH');\n  }\n\n  /**\n   * Calls fetch with request method set to DELETE.\n   *\n   * @param input The resource that you wish to fetch. Either a\n   * Request object, or a string containing the URL of the resource.\n   * @param body The body of the request.\n   * @param init An options object containing settings to be applied to\n   * the Request.\n   * @returns A Promise for the Response from the fetch request.\n   */\n  public delete(input: Request | string, body?: BodyInit, init?: RequestInit): Promise<Response> {\n    return this.callFetch(input, body, init, 'DELETE');\n  }\n\n  private trackRequestStart(): void {\n    this.isRequesting = !!(++this.activeRequestCount);\n    if (this.isRequesting) {\n      const evt = DOM.createCustomEvent('aurelia-fetch-client-request-started', { bubbles: true, cancelable: true });\n      PLATFORM.setTimeout(() => { DOM.dispatchEvent(evt); }, 1);\n    }\n  }\n\n  private trackRequestEnd(): void {\n    this.isRequesting = !!(--this.activeRequestCount);\n    if (!this.isRequesting) {\n      const evt = DOM.createCustomEvent('aurelia-fetch-client-requests-drained', { bubbles: true, cancelable: true });\n      PLATFORM.setTimeout(() => { DOM.dispatchEvent(evt); }, 1);\n    }\n  }\n\n  private processRequest(request: Request, interceptors: Interceptor[]): Promise<Request | Response> {\n    return this.applyInterceptors(request, interceptors, 'request', 'requestError', this);\n  }\n\n  private processResponse(response: Promise<Response>, interceptors: Interceptor[], request: Request): Promise<Request | Response> {\n    return this.applyInterceptors(response, interceptors, 'response', 'responseError', request, this);\n  }\n\n  private applyInterceptors(input: Request | Promise<Response | Request>, interceptors: Interceptor[] | undefined, successName: ValidInterceptorMethodName, errorName: ValidInterceptorMethodName, ...interceptorArgs: unknown[]): Promise<Request | Response> {\n    return (interceptors !== undefined ? interceptors : [])\n      .reduce(\n        (chain, interceptor) => {\n          const successHandler = interceptor[successName];\n          const errorHandler = interceptor[errorName];\n\n          // TODO: Fix this, as it violates `strictBindCallApply`.\n          return chain.then(\n            successHandler ? (value => successHandler.call(interceptor, value, ...interceptorArgs)) : identity,\n            errorHandler ? (reason => errorHandler.call(interceptor, reason, ...interceptorArgs)) : thrower);\n        },\n        Promise.resolve(input)\n      );\n  }\n\n  private callFetch(input: string | Request, body: BodyInit | undefined, init: RequestInit | undefined, method: string): Promise<Response> {\n    if (!init) {\n      init = {};\n    }\n    init.method = method;\n    if (body) {\n      init.body = body;\n    }\n    return this.fetch(input, init);\n  }\n}\n\nfunction parseHeaderValues(headers: Record<string, unknown> | undefined): Record<string, string>  {\n  const parsedHeaders: Record<string, string> = {};\n  const $headers = headers !== undefined ? headers : {};\n  for (const name in $headers) {\n    if ($headers.hasOwnProperty(name)) {\n      parsedHeaders[name] = (typeof $headers[name] === 'function')\n        ? ($headers[name] as () => string)()\n        : $headers[name] as string;\n    }\n  }\n  return parsedHeaders;\n}\n\nfunction getRequestUrl(baseUrl: string, url: string): string {\n  if (absoluteUrlRegexp.test(url)) {\n    return url;\n  }\n\n  return (baseUrl !== undefined ? baseUrl : '') + url;\n}\n\nfunction setDefaultHeaders(headers: Headers, defaultHeaders?: Record<string, string>): void {\n  const $defaultHeaders = defaultHeaders !== undefined ? defaultHeaders : {};\n  for (const name in $defaultHeaders) {\n    if ($defaultHeaders.hasOwnProperty(name) && !headers.has(name)) {\n      headers.set(name, $defaultHeaders[name]);\n    }\n  }\n}\n\nfunction isJSON(str: unknown): boolean {\n  try {\n    JSON.parse(str as string);\n  } catch (err) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction identity(x: unknown): unknown {\n  return x;\n}\n\nfunction thrower(x: unknown): never {\n  throw x;\n}\n"],"names":["PLATFORM","DOM","IDOM"],"mappings":"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"}