(function(t,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports,require("@aurelia/kernel")):"function"==typeof define&&define.amd?define(["exports","@aurelia/kernel"],s):s((t=t||self).runtime={},t.kernel)})(this,function(t,kernel){"use strict";function s(strategy){return 0==(strategy&kt)||8===strategy?1|strategy:strategy}function i(t,s,i,n){var h,e,r=arguments.length,o=3>r?s:null===n?n=Object.getOwnPropertyDescriptor(s,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,s,i,n);else for(e=t.length-1;e>=0;e--)(h=t[e])&&(o=(3>r?h(o):r>3?h(s,i,o):h(s,i))||o);return r>3&&o&&Object.defineProperty(s,i,o),o}function subscriberCollection(s){return function(i){const u=i.prototype;switch(u.t=0,u.s=null,u.i=null,u.h=null,u.o=null,u.l=n,u.u=h,u.p=c,u.v=l,s){case t.MutationKind.g:u.m=e;break;case t.MutationKind.C:u.m=r;break;case t.MutationKind.O:u.m=o}}}function n(t){if(this.p(t))return 0;const s=this.t;return 1&s?2&s?4&s?8&s?(this.o.push(t),1):(this.o=[t],this.t|=8,1):(this.h=t,this.t|=4,1):(this.i=t,this.t|=2,1):(this.s=t,this.t|=1,1)}function h(t){const s=this.t;if(1&s&&this.s===t)return this.s=null,this.t&=-2,1;if(2&s&&this.i===t)return this.i=null,this.t&=-3,1;if(4&s&&this.h===t)return this.h=null,this.t&=-5,1;if(8&s){const s=this.o;for(let i=0,n=s.length;n>i;++i)if(s[i]===t)return s.splice(i,1),1===n&&(this.t&=-9),1}return 0}function e(t,s,i){const n=this.s,h=this.i,e=this.h;let r=this.o;null!==r&&(r=r.slice()),null!==n&&n.j(t,s,i),null!==h&&h.j(t,s,i),null!==e&&e.j(t,s,i);const o=r&&r.length;if(void 0!==o&&o>0)for(let n=0;o>n;++n){const h=r[n];null!==h&&h.j(t,s,i)}}function r(t,s,i){const n=this.s,h=this.i,e=this.h;let r=this.o;null!==r&&(r=r.slice()),null!==n&&n.j(t,s,i),null!==h&&h.j(t,s,i),null!==e&&e.j(t,s,i);const o=r&&r.length;if(void 0!==o&&o>0)for(let n=0;o>n;++n){const h=r[n];null!==h&&h.j(t,s,i)}this.T.A(this).catch(t=>{throw t})}function o(t,s,i,n){const h=this.s,e=this.i,r=this.h;let o=this.o;null!==o&&(o=o.slice()),null!==h&&h.j(t,s,i,n),null!==e&&e.j(t,s,i,n),null!==r&&r.j(t,s,i,n);const l=o&&o.length;if(void 0!==l&&l>0)for(let h=0;l>h;++h){const e=o[h];null!==e&&e.j(t,s,i,n)}}function l(){return 0!==this.t}function c(t){const s=this.t;if(1&s&&this.s===t)return 1;if(2&s&&this.i===t)return 1;if(4&s&&this.h===t)return 1;if(8&s){const s=this.o;for(let i=0,n=s.length;n>i;++i)if(s[i]===t)return 1}return 0}function batchedSubscriberCollection(){return function(t){const s=t.prototype;s.S=0,s.R=null,s.$=null,s.I=null,s.k=null,s.P=u,s.V=a,s.D=b,s.L=d,s.B=f}}function u(t){if(this.D(t))return 0;const s=this.S;return 1&s?2&s?4&s?8&s?(this.k.push(t),1):(this.k=[t],this.S|=8,1):(this.I=t,this.S|=4,1):(this.$=t,this.S|=2,1):(this.R=t,this.S|=1,1)}function a(t){const s=this.S;if(1&s&&this.R===t)return this.R=null,this.S&=-2,1;if(2&s&&this.$===t)return this.$=null,this.S&=-3,1;if(4&s&&this.I===t)return this.I=null,this.S&=-5,1;if(8&s){const s=this.k;for(let i=0,n=s.length;n>i;++i)if(s[i]===t)return s.splice(i,1),1===n&&(this.S&=-9),1}return 0}function f(t,s){const i=this.R,n=this.$,h=this.I;let e=this.k;null!==e&&(e=e.slice()),null!==i&&i.N(t,s),null!==n&&n.N(t,s),null!==h&&h.N(t,s);const r=e&&e.length;if(void 0!==r&&r>0)for(let i=0;r>i;++i){const n=e[i];null!==n&&n.N(t,s)}}function d(){return 0!==this.S}function b(t){const s=this.S;if(1&s&&this.R===t)return 1;if(2&s&&this.$===t)return 1;if(4&s&&this.I===t)return 1;if(8&s){const s=this.k;for(let i=0,n=s.length;n>i;++i)if(s[i]===t)return 1}return 0}function p(value){return null!==value&&"object"==typeof value}function v(value,s){if(p(value))if(void 0!==value.F){const i=value.F;let n,h;for(n in i)void 0!==(h=i[n]).M&&h.M(s|t.LifecycleFlags.U|t.LifecycleFlags.q|t.LifecycleFlags.H)}else void 0!==value.K&&void 0!==value.K.M&&value.K.M(s|t.LifecycleFlags.U|t.LifecycleFlags.q|t.LifecycleFlags.H)}function g(s){0==this.W&&(this.W=1,this._=this.G[this.J],0==(this.X&t.LifecycleFlags.U)&&(Lt.get=(()=>this.Y()),Lt.set=(value=>{this.Z(value,t.LifecycleFlags.q)}),Dt(this.G,this.J,Lt)||kernel.Reporter.write(1,this.J,this.G))),this.l(s)}function w(){Reflect.deleteProperty(this.G,this.J),this.G=null,this.J=null,this._=null}function propertyObserver(){return function(s){subscriberCollection(t.MutationKind.g)(s);const i=s.prototype;i.W=0,i.G=null,i.J=null,i._=Symbol(),i.subscribe=i.subscribe||g,i.unsubscribe=i.unsubscribe||i.u,i.tt=i.tt||w}}function m(t){const s=BindingBehaviorResource.st(this.description.name);t.register(kernel.Registration.singleton(s,this))}function y(t){const s=this.kind.st(this.description.name);t.register(kernel.Registration.singleton(s,this))}function hasBind(t){return 2048==(2048&t.it)}function hasUnbind(t){return 4096==(4096&t.it)}function isLiteral(t){return 16384==(16384&t.it)}function arePureLiterals(t){if(void 0===t||0===t.length)return 1;for(let s=0;t.length>s;++s)if(!isPureLiteral(t[s]))return 0;return 1}function isPureLiteral(t){if(isLiteral(t))switch(t.it){case 17955:return arePureLiterals(t.elements);case 17956:return arePureLiterals(t.values);case 17958:return arePureLiterals(t.nt);case 17925:return 1}return 0}function C(t,s,i,n){const h=n.length,e=Array(h);for(let r=0;h>r;++r)e[r]=n[r].evaluate(t,s,i);return e}function O(s,i,name){const n=null==i?null:i[name];if("function"==typeof n)return n;if(!(s&t.LifecycleFlags.ht)&&null==n)return null;throw kernel.Reporter.error(207,i,name,n)}function j(t){if(t===Kt){const s=Qt.length=Ht.length=(Kt+=5)+1;for(let i=t+1;s>i;++i)Qt[i]=`_observer${i}`,Ht[i]=`_observerVersion${i}`}}function A(t){const s=void 0===this.et?0:this.et;let i=s;for(;i--&&this[Qt[i]]!==t;);if(-1===i){for(i=0;this[Qt[i]];)i++;this[Qt[i]]=t,t.subscribe(this),i===s&&(this.et=i+1)}void 0===this.version&&(this.version=0),this[Ht[i]]=this.version,j(i)}function T(t,s,i){const n=this.ot.rt(t,s,i);this.lt(n)}function S(all){const t=this.et;let s,i;if(1==all)for(let n=0;t>n;++n)null!=(i=this[s=Qt[n]])&&(this[s]=null,i.unsubscribe(this));else{const n=this.version;for(let h=0;t>h;++h)this[Ht[h]]!==n&&null!=(i=this[s=Qt[h]])&&(this[s]=null,i.unsubscribe(this))}}function R(t){const s=t.prototype;return s.hasOwnProperty("observeProperty")||(s.ct=T),s.hasOwnProperty("unobserve")||(s.unobserve=S),s.hasOwnProperty("addObserver")||(s.lt=A),t}function connectable(t){return void 0===t?R:R(t)}function $(s,i){if(this._!==(s=null==s?this.defaultValue:s)){if(this._=s,!(i&(t.LifecycleFlags.H|t.LifecycleFlags.ut))||this.at&&i&t.LifecycleFlags.ft)return this.dt=i,this.T.A(this);this.bt(s,i)}return Promise.resolve()}function I(s){if(this.at&&s&t.LifecycleFlags.ft)return void this.T.A(this).catch(t=>{throw t});const i=this._;this.oldValue!==i&&(this.bt(i,this.dt|s|t.LifecycleFlags.q),this.oldValue=this._)}function k(s){const i=this.Y();this._!==i&&(this.bt(i,this.dt|s|t.LifecycleFlags.q),this._=i),v(i,s)}function P(){this._=null,this.oldValue=null,this.defaultValue=null,this.G=null,this.J=""}function targetObserver(s=null){return function(i){subscriberCollection(t.MutationKind.g)(i);const n=i.prototype;n.pt=null,n._=s,n.oldValue=s,n.defaultValue=s,n.G=null,n.J="",n.M=n.M||k,n.Z=n.Z||$,n.flush=n.flush||I,n.tt=n.tt||P}}function V(s){this.B(this.vt,s|this.X),this.gt&&this.gt.M(t.LifecycleFlags.H|t.LifecycleFlags.q|this.X),this.wt()}function D(){this.C.K=void 0,this.C=null,this.vt=null}function L(){const t=this.C.length,s=this.vt=Array(t);let i=0;for(;t>i;)s[i]=i++;s.yt=[]}function B(){const t=this.C.size,s=this.vt=Array(t);let i=0;for(;t>i;)s[i]=i++;s.yt=[]}function N(){return void 0===this.gt?this.gt=new t.CollectionLengthObserver(this,this.Ct):this.gt}function collectionObserver(s){return function(i){subscriberCollection(t.MutationKind.C)(i),batchedSubscriberCollection()(i);const n=i.prototype;n.pt=null,n.C=null,n.vt=null,n.Ot=0,n.Ct=8&s?"length":"size",n.jt=s,n.wt=8&s?L:B,n.flush=V,n.tt=D,n.At=N,n.subscribe=n.subscribe||n.l,n.unsubscribe=n.unsubscribe||n.u,n.Tt=n.Tt||n.P,n.St=n.St||n.V}}function x(t,s){return t===s?0:(s=null===s?"null":""+s)>(t=null===t?"null":""+t)?-1:1}function F(t,s){return void 0===t?void 0===s?0:1:void 0===s?-1:0}function M(t,s,from,to,i){let n,h,e,r,o,l,c;for(l=from+1;to>l;l++){for(n=t[l],h=s[l],c=l-1;c>=from&&(r=s[c],(o=i(e=t[c],n))>0);c--)t[c+1]=e,s[c+1]=r;t[c+1]=n,s[c+1]=h}}function U(t,s,from,to,i){let n,h,e,r,o,l,c,u,a,f,d,b,p,v,g,w,m,y,C,O=0,j=0;for(;;){if(10>=to-from)return void M(t,s,from,to,i);r=s[from],o=s[to-1],e=t[O=from+(to-from>>1)],l=s[O],(c=i(n=t[from],h=t[to-1]))>0&&(f=n,d=r,n=h,r=o,h=f,o=d),0>(u=i(n,e))?(a=i(h,e))>0&&(f=h,d=o,h=e,o=l,e=f,l=d):(f=n,d=r,n=e,r=l,e=h,l=o,h=f,o=d),t[from]=n,s[from]=r,t[to-1]=e,s[to-1]=l,b=h,p=o,g=to-1,t[O]=t[v=from+1],s[O]=s[v],t[v]=b,s[v]=p;t:for(j=v+1;g>j;j++)if(m=s[j],0>(y=i(w=t[j],b)))t[j]=t[v],s[j]=s[v],t[v]=w,s[v]=m,v++;else if(y>0){do{if(--g==j)break t;y=i(C=t[g],b)}while(y>0);t[j]=t[g],s[j]=s[g],t[g]=w,s[g]=m,0>y&&(w=t[j],m=s[j],t[j]=t[v],s[j]=s[v],t[v]=w,s[v]=m,v++)}v-from>to-g?(U(t,s,g,to,i),to=v):(U(t,s,from,v,i),from=g)}}function enableArrayObservation(){for(const t of ls)1!=Zt[t].W&&def(Zt,t,Object.assign({},us,{value:cs[t]}))}function E(s,i,n){return n.K||new t.ArrayObserver(s,i,n)}function enableMapObservation(){for(const t of vs)1!=as[t].W&&ms(as,t,Object.assign({},ws,{value:gs[t]}))}function z(s,i,n){return n.K||new t.MapObserver(s,i,n)}function enableSetObservation(){for(const t of Ts)1!=ys[t].W&&$s(ys,t,Object.assign({},Rs,{value:Ss[t]}))}function q(s,i,n){return n.K||new t.SetObserver(s,i,n)}function getCollectionObserver(s,i,n){const h=n instanceof Object?t.ProxyObserver.Rt(n):n;switch(Ds.call(n)){case"[object Array]":return E(s,i,h);case"[object Map]":return z(s,i,h);case"[object Set]":return q(s,i,h)}return null}function Q(t,s,i){const n=this.$t;kernel.PLATFORM.global.clearTimeout(n.It),n.It=kernel.PLATFORM.global.setTimeout(()=>{this.kt(t,s,i)},n.Pt)}function H(t,s,i){const n=this.$t;if(kernel.PLATFORM.global.clearTimeout(n.It),!(i&n.Vt))return n.oldValue=Us,void this.kt(t,s,i);n.oldValue===Us&&(n.oldValue=s);const h=kernel.PLATFORM.global.setTimeout(()=>{const s=n.oldValue;n.oldValue=Us,this.kt(t,s,i)},n.Pt);n.It=h}function K(t){const s=this.Dt,i=+new Date-s.Lt;if(i>=s.Pt)return kernel.PLATFORM.global.clearTimeout(s.It),s.It=-1,s.Lt=+new Date,void this.Bt(t);if(s.newValue=t,-1===s.It){const t=kernel.PLATFORM.global.setTimeout(()=>{s.It=-1,s.Lt=+new Date,this.Bt(s.newValue)},s.Pt-i);s.It=t}}function bindable(t,s){let i;const n=function(t,s){arguments.length>1&&(i.Nt=s),zs.for(t.constructor).add(i)};return arguments.length>1?(i={},void n(t,s)):"string"==typeof t?(i={},n):(i=t||{},n)}function W(name){return`${qs}:${name}`}function _(t){return void 0===t.$customElement?null:t.$customElement}function G(name){return`${Qs}:${name}`}function buildTemplateDefinition(t,i,template,cache,build,bindables,instructions,dependencies,surrogates,containerless,shadowOptions,hasSlots,strategy){const def=new Ws,n=arguments.length;switch(n){case 13:null!==strategy&&(def.strategy=s(strategy));case 12:null!==hasSlots&&(def.hasSlots=hasSlots);case 11:null!==shadowOptions&&(def.shadowOptions=shadowOptions);case 10:null!==containerless&&(def.containerless=containerless);case 9:null!==surrogates&&(def.surrogates=kernel.PLATFORM.toArray(surrogates));case 8:null!==dependencies&&(def.dependencies=kernel.PLATFORM.toArray(dependencies));case 7:null!==instructions&&(def.instructions=kernel.PLATFORM.toArray(instructions));case 6:null!==bindables&&(def.bindables=Object.assign({},bindables));case 5:null!==build&&(def.build=1==build?Hs:0==build?Ks:Object.assign({},build));case 4:null!==cache&&(def.cache=cache);case 3:null!==template&&(def.template=template);case 2:null!==t&&(t.bindables&&(def.bindables=zs.for(t).get()),t.containerless&&(def.containerless=t.containerless),t.shadowOptions&&(def.shadowOptions=t.shadowOptions)),"string"==typeof i?i.length>0&&(def.name=i):null!==i&&(def.strategy=s(i.strategy),_s.forEach(t=>{i[t]&&(def[t]=i[t])}),Gs.forEach(t=>{i[t]&&(def[t]=kernel.PLATFORM.toArray(i[t]))}),i.bindables&&(def.bindables===kernel.PLATFORM.xt?def.bindables=zs.for(i).get():Object.assign(def.bindables,i.bindables)))}return 2!==n||null===t||"string"!=typeof i&&"build"in i||(def.build=Hs),def}function J(s){if(8&this.$state)return;const i=this.$lifecycle;i.Ft(),this.$state|=4,s|=t.LifecycleFlags.Mt;const n=this.$hooks;16&n&&this.Ut(s),this.$state|=8,this.$state&=-5,32&n&&i.Et(this),i.zt(s)}function X(s){if(8&this.$state)return;const i=this.$lifecycle;i.Ft(),this.$state|=4,s|=t.LifecycleFlags.Mt;const n=this.$hooks;16&n&&this.Ut(s);let h=this.qt;for(;null!==h;)h.Qt(s),h=h.Ht;i.Kt(this),this.$state|=8,this.$state&=-5,32&n&&i.Et(this),i.zt(s)}function Y(s){if(8&this.$state)return;this.$state|=4,s|=t.LifecycleFlags.Mt;let i=this.qt;for(;null!==i;)i.Qt(s),i=i.Ht;this.$lifecycle.Kt(this),this.$state|=8,this.$state&=-5}function Z(s){if(8&this.$state){const i=this.$lifecycle;i.Wt(),this.$state|=32,s|=t.LifecycleFlags._t;const n=this.$hooks;64&n&&this.Gt(s),this.$state&=-41,128&n&&i.Jt(this),i.Xt(s)}}function tt(s){if(8&this.$state){const i=this.$lifecycle;i.Wt(),this.$state|=32,(s|=t.LifecycleFlags._t)&t.LifecycleFlags.Yt^t.LifecycleFlags.Yt|s&t.LifecycleFlags.Zt&&(i.ts(this),s|=t.LifecycleFlags.Yt);const n=this.$hooks;64&n&&this.Gt(s);let h=this.ss;for(;null!==h;)h.ns(s),h=h.hs;this.$state&=-41,128&n&&i.Jt(this),i.Xt(s)}}function st(s){if(8&this.$state){this.$state|=32,(s|=t.LifecycleFlags._t)&t.LifecycleFlags.Yt^t.LifecycleFlags.Yt|s&t.LifecycleFlags.Zt&&(this.$lifecycle.ts(this),s|=t.LifecycleFlags.Yt);let i=this.ss;for(;null!==i;)i.ns(s),i=i.hs;this.$state&=-41}}function it(s){2048&this.$hooks&&this.es(s|=t.LifecycleFlags.rs)}function nt(s){s|=t.LifecycleFlags.rs,2048&this.$hooks&&this.es(s);let i=this.ss;for(;null!==i;)i.os(s),i=i.hs}function ht(s){s|=t.LifecycleFlags.rs;let i=this.ss;for(;null!==i;)i.os(s),i=i.hs}function et(){16&this.$state||(this.$state|=16,this.cs.ls(this.$nodes))}function rt(){16&this.$state&&(this.$state&=-17,this.cs.us(this.$nodes))}function ot(){16&this.$state||(this.$state|=16,this.$nodes.insertBefore(this.location))}function lt(){return 16&this.$state?(this.$state&=-17,this.$nodes.remove(),this.as&&(this.as=0,this.cache.fs(this))?(this.$state|=128,1):0):0}function ct(s,i){if(s|=t.LifecycleFlags.ut,2&this.$state){if(this.$scope===i)return;this.ds(s)}const n=this.$lifecycle;n.bs(),this.$state|=1;const h=this.$hooks;8&h&&n.ps(this),this.$scope=i,4&h&&this.vs(s),this.$state|=2,this.$state&=-2,n.gs(s)}function ut(s,i){if(2&this.$state)return;const n=this.$scope;n.ws=i;const h=this.$lifecycle;h.bs(),this.$state|=1;const e=this.$hooks;s|=t.LifecycleFlags.ut,8&e&&h.ps(this);let r=this.ms;for(;null!==r;)r.ys(s,n),r=r.Cs;4&e&&this.vs(s);let component=this.qt;for(;null!==component;)component.ys(s,n),component=component.Ht;this.$state|=2,this.$state&=-2,h.gs(s)}function at(s,i){if(s|=t.LifecycleFlags.ut,2&this.$state){if(this.$scope===i)return;this.ds(s)}this.$state|=1,this.$scope=i;let n=this.ms;for(;null!==n;)n.ys(s,i),n=n.Cs;let component=this.qt;for(;null!==component;)component.ys(s,i),component=component.Ht;this.$state|=2,this.$state&=-2}function ft(s){if(s|=t.LifecycleFlags.ut,2&this.$state)return;this.$state|=1;const i=this.$scope;let n=this.ms;for(;null!==n;)n.ys(s,i),n=n.Cs;let component=this.qt;for(;null!==component;)component.ys(s,i),component=component.Ht;this.$state|=2,this.$state&=-2}function dt(s){if(2&this.$state){const i=this.$lifecycle;i.Os(),this.$state|=64;const n=this.$hooks;s|=t.LifecycleFlags.js,512&n&&i.As(this),256&n&&this.Ts(s),this.$state&=-67,i.Ss(s)}}function bt(s){if(2&this.$state){const i=this.$lifecycle;i.Os(),this.$state|=64;const n=this.$hooks;s|=t.LifecycleFlags.js,512&n&&i.As(this),256&n&&this.Ts(s);let component=this.ss;for(;null!==component;)component.ds(s),component=component.hs;let h=this.Rs;for(;null!==h;)h.ds(s),h=h.$s;this.$scope.ws=null,this.$state&=-67,i.Ss(s)}}function pt(s){if(2&this.$state){this.$state|=64,s|=t.LifecycleFlags.js;let component=this.ss;for(;null!==component;)component.ds(s),component=component.hs;let i=this.Rs;for(;null!==i;)i.ds(s),i=i.$s;this.$state&=-67,this.$scope=null}}function vt(s){if(2&this.$state){this.$state|=64,s|=t.LifecycleFlags.js;let component=this.ss;for(;null!==component;)component.ds(s),component=component.hs;let i=this.Rs;for(;null!==i;)i.ds(s),i=i.$s;this.$state&=-67}}function gt(t){v(this,t);let component=this.qt;for(;component;)component.M(t),component=component.Ht;let s=this.ms;for(;s;)void 0!==s.M&&s.M(t),s=s.Cs}function createRenderContext(dom,t,dependencies,s){const i=t.Is(),n=new ni,h=new ni,e=new ni,r=new hi,o=new ni,l=i.get(IRenderer);return dom.ks(i,h),i.Ps(IViewFactory,r),i.Ps(IRenderable,n),i.Ps(ITargetedInstruction,e),i.Ps(IRenderLocation,o),dependencies&&i.register(...dependencies),s&&s.register(i),i.Vs=function(t,s,targets,i,host,parts){l.Vs(t,dom,this,s,targets,i,host,parts)},i.Ds=function(t,s,l,c,parts,u){return n.Ls(t),h.Ls(s),e.Ls(l),c&&r.Ls(c,parts),u&&o.Ls(u),i},i.tt=function(){r.tt(),n.tt(),e.tt(),h.tt(),o.tt()},i}function wt(t){const s=[];for(let i=0,n=t.length;n>i;++i){const component=_(t[i]);null!==component&&s.push(component)}return s}function mt(s,i,name){Reflect.defineProperty(i,name,{Bs:1,get(){return this.F[name].Y()},set(value){this.F[name].Z(value,s&t.LifecycleFlags.Ns|t.LifecycleFlags.q)}})}function yt(t){const s=this.kind.st(this.description.name);t.register(kernel.Registration.transient(s,this))}function Ct(t){return t.containerless=1,t}function Ot(s,i){const n=this.constructor;s|=n.description.strategy;const h=i.get(IRenderingEngine);let e;e=s&t.LifecycleFlags.xs?t.ProxyObserver.Fs(this).O:this,h.Ms(s,n,this),2&this.$hooks&&e.Us(s)}function jt(s,i,host,n=kernel.PLATFORM.xt){const h=this.constructor,e=h.description;s|=e.strategy;const r=i.get(IProjectorLocator),o=i.get(IRenderingEngine),dom=i.get(IDOM);let l;if(l=s&t.LifecycleFlags.xs?t.ProxyObserver.Fs(this).O:this,this.$scope=Scope.create(s,l,null),this.Es=host,this.cs=r.zs(dom,this,host,e),o.Ms(s,h,this),1024&this.$hooks){const t=this.Vs(s,host,n.parts,i);t&&"getElementTemplate"in t&&t.qs(o,h,i).Vs(this,host,n.parts)}else o.qs(dom,e,i,h).Vs(this,host,n.parts);2&this.$hooks&&l.Us(s)}function At(t){const s=this.description,i=this.kind.st(s.name),aliases=s.aliases;t.register(kernel.Registration.transient(i,this));for(let s=0,n=aliases.length;n>s;++s){const n=this.kind.st(aliases[s]);t.register(kernel.Registration.Qs(i,n))}}function Tt(t){return t.Hs=1,t}function instructionRenderer(t){return function(s){const i=function(...i){const n=new s(...i);return n.Ks=t,n};i.register=function(t){return kernel.Registration.singleton(IInstructionRenderer,i).register(t,IInstructionRenderer)};const n=Object.getOwnPropertyDescriptors(s);return Object.keys(n).filter(t=>"prototype"!==t).forEach(t=>{Reflect.defineProperty(i,t,n[t])}),i}}function ensureExpression(t,s,i){return"string"==typeof s?t.parse(s,i):s}function addBinding(t,s){s.$s=t.Rs,s.Cs=null,null===t.Rs?t.ms=s:t.Rs.Cs=s,t.Rs=s}function addComponent(t,component){component.hs=t.ss,component.Ht=null,null===t.ss?t.qt=component:t.ss.Ht=component,t.ss=component}var St,Rt,$t,It,BindingMode,BindingStrategy,State,Hooks,LifecycleFlags,ExpressionKind,DelegationStrategy,MutationKind,CollectionKind,BindingType,TargetedInstructionType,ViewCompileFlags;(BindingMode=t.BindingMode||(t.BindingMode={}))[BindingMode.oneTime=1]="oneTime",BindingMode[BindingMode.Ws=2]="toView",BindingMode[BindingMode._s=4]="fromView",BindingMode[BindingMode.Gs=6]="twoWay",BindingMode[BindingMode.default=8]="default",(BindingStrategy=t.BindingStrategy||(t.BindingStrategy={}))[BindingStrategy.Js=1]="getterSetter",BindingStrategy[BindingStrategy.Xs=2]="proxies",BindingStrategy[BindingStrategy.Ys=4]="patch",BindingStrategy[BindingStrategy.Zs=8]="keyed";const kt=7;(State=t.State||(t.State={}))[State.ti=0]="none",State[State.si=1]="isBinding",State[State.ii=2]="isBound",State[State.ni=4]="isAttaching",State[State.hi=8]="isAttached",State[State.ei=16]="isMounted",State[State.ri=32]="isDetaching",State[State.oi=64]="isUnbinding",State[State.li=128]="isCached",State[State.ci=256]="isContainerless",State[State.ui=512]="isPatching",(Hooks=t.Hooks||(t.Hooks={}))[Hooks.ti=1]="none",Hooks[Hooks.ai=2]="hasCreated",Hooks[Hooks.fi=4]="hasBinding",Hooks[Hooks.di=8]="hasBound",Hooks[Hooks.bi=16]="hasAttaching",Hooks[Hooks.pi=32]="hasAttached",Hooks[Hooks.vi=64]="hasDetaching",Hooks[Hooks.gi=128]="hasDetached",Hooks[Hooks.wi=256]="hasUnbinding",Hooks[Hooks.mi=512]="hasUnbound",Hooks[Hooks.yi=1024]="hasRender",Hooks[Hooks.Ci=2048]="hasCaching",(LifecycleFlags=t.LifecycleFlags||(t.LifecycleFlags={}))[LifecycleFlags.ti=0]="none",LifecycleFlags[LifecycleFlags.ht=8388608]="mustEvaluate",LifecycleFlags[LifecycleFlags.Oi=15]="bindingStrategy",LifecycleFlags[LifecycleFlags.ji=1]="getterSetterStrategy",LifecycleFlags[LifecycleFlags.xs=2]="proxyStrategy",LifecycleFlags[LifecycleFlags.U=4]="patchStrategy",LifecycleFlags[LifecycleFlags.Ai=8]="keyedStrategy",LifecycleFlags[LifecycleFlags.Ti=48]="mutation",LifecycleFlags[LifecycleFlags.Si=16]="isCollectionMutation",LifecycleFlags[LifecycleFlags.Ri=32]="isInstanceMutation",LifecycleFlags[LifecycleFlags.update=448]="update",LifecycleFlags[LifecycleFlags.$i=64]="updateTargetObserver",LifecycleFlags[LifecycleFlags.q=128]="updateTargetInstance",LifecycleFlags[LifecycleFlags.Ii=256]="updateSourceExpression",LifecycleFlags[LifecycleFlags.from=8388096]="from",LifecycleFlags[LifecycleFlags.H=3584]="fromFlush",LifecycleFlags[LifecycleFlags.ki=512]="fromAsyncFlush",LifecycleFlags[LifecycleFlags.Pi=1024]="fromSyncFlush",LifecycleFlags[LifecycleFlags.Vi=2048]="fromTick",LifecycleFlags[LifecycleFlags.Di=4096]="fromStartTask",LifecycleFlags[LifecycleFlags.Zt=8192]="fromStopTask",LifecycleFlags[LifecycleFlags.ut=16384]="fromBind",LifecycleFlags[LifecycleFlags.js=32768]="fromUnbind",LifecycleFlags[LifecycleFlags.Mt=65536]="fromAttach",LifecycleFlags[LifecycleFlags._t=131072]="fromDetach",LifecycleFlags[LifecycleFlags.rs=262144]="fromCache",LifecycleFlags[LifecycleFlags.Li=524288]="fromDOMEvent",LifecycleFlags[LifecycleFlags.Bi=1048576]="fromObserverSetter",LifecycleFlags[LifecycleFlags.Ni=2097152]="fromBindableHandler",LifecycleFlags[LifecycleFlags.xi=4194304]="fromLifecycleTask",LifecycleFlags[LifecycleFlags.Yt=16777216]="parentUnmountQueued",LifecycleFlags[LifecycleFlags.ft=33554432]="doNotUpdateDOM",LifecycleFlags[LifecycleFlags.Fi=67108864]="isTraversingParentScope",LifecycleFlags[LifecycleFlags.Mi=134217728]="isOriginalArray",LifecycleFlags[LifecycleFlags.Ns=268435471]="persistentBindingFlags",LifecycleFlags[LifecycleFlags.Ui=268435456]="allowParentScopeTraversal",(ExpressionKind=t.ExpressionKind||(t.ExpressionKind={}))[ExpressionKind.Connects=32]="Connects",ExpressionKind[ExpressionKind.Observes=64]="Observes",ExpressionKind[ExpressionKind.CallsFunction=128]="CallsFunction",ExpressionKind[ExpressionKind.HasAncestor=256]="HasAncestor",ExpressionKind[ExpressionKind.IsPrimary=512]="IsPrimary",ExpressionKind[ExpressionKind.IsLeftHandSide=1024]="IsLeftHandSide",ExpressionKind[ExpressionKind.HasBind=2048]="HasBind",ExpressionKind[ExpressionKind.HasUnbind=4096]="HasUnbind",ExpressionKind[ExpressionKind.IsAssignable=8192]="IsAssignable",ExpressionKind[ExpressionKind.IsLiteral=16384]="IsLiteral",ExpressionKind[ExpressionKind.IsResource=32768]="IsResource",ExpressionKind[ExpressionKind.Ei=65536]="IsForDeclaration",ExpressionKind[ExpressionKind.zi=31]="Type",ExpressionKind[ExpressionKind.AccessThis=1793]="AccessThis",ExpressionKind[ExpressionKind.AccessScope=10082]="AccessScope",ExpressionKind[ExpressionKind.ArrayLiteral=17955]="ArrayLiteral",ExpressionKind[ExpressionKind.ObjectLiteral=17956]="ObjectLiteral",ExpressionKind[ExpressionKind.PrimitiveLiteral=17925]="PrimitiveLiteral",ExpressionKind[ExpressionKind.Template=17958]="Template",ExpressionKind[ExpressionKind.Unary=39]="Unary",ExpressionKind[ExpressionKind.CallScope=1448]="CallScope",ExpressionKind[ExpressionKind.CallMember=1161]="CallMember",ExpressionKind[ExpressionKind.CallFunction=1162]="CallFunction",ExpressionKind[ExpressionKind.AccessMember=9323]="AccessMember",ExpressionKind[ExpressionKind.AccessKeyed=9324]="AccessKeyed",ExpressionKind[ExpressionKind.TaggedTemplate=1197]="TaggedTemplate",ExpressionKind[ExpressionKind.Binary=46]="Binary",ExpressionKind[ExpressionKind.Conditional=63]="Conditional",ExpressionKind[ExpressionKind.Assign=8208]="Assign",ExpressionKind[ExpressionKind.ValueConverter=36913]="ValueConverter",ExpressionKind[ExpressionKind.BindingBehavior=38962]="BindingBehavior",ExpressionKind[ExpressionKind.HtmlLiteral=51]="HtmlLiteral",ExpressionKind[ExpressionKind.ArrayBindingPattern=65556]="ArrayBindingPattern",ExpressionKind[ExpressionKind.ObjectBindingPattern=65557]="ObjectBindingPattern",ExpressionKind[ExpressionKind.BindingIdentifier=65558]="BindingIdentifier",ExpressionKind[ExpressionKind.ForOfStatement=6199]="ForOfStatement",ExpressionKind[ExpressionKind.Interpolation=24]="Interpolation",(function(t){t[t.qi=0]="None",t[t.Qi=1]="Subscriber0",t[t.Hi=2]="Subscriber1",t[t.Ki=4]="Subscriber2",t[t.Wi=8]="SubscribersRest",t[t._i=15]="Any"})(St||(St={})),(DelegationStrategy=t.DelegationStrategy||(t.DelegationStrategy={}))[DelegationStrategy.ti=0]="none",DelegationStrategy[DelegationStrategy.Gi=1]="capturing",DelegationStrategy[DelegationStrategy.Ji=2]="bubbling",(MutationKind=t.MutationKind||(t.MutationKind={}))[MutationKind.g=1]="instance",MutationKind[MutationKind.C=2]="collection",MutationKind[MutationKind.O=4]="proxy",(CollectionKind=t.CollectionKind||(t.CollectionKind={}))[CollectionKind.Xi=8]="indexed",CollectionKind[CollectionKind.Zs=4]="keyed",CollectionKind[CollectionKind.Yi=9]="array",CollectionKind[CollectionKind.map=6]="map",CollectionKind[CollectionKind.set=7]="set";const Pt=new WeakMap;let Vt=class{constructor(s,i,n){this.raw=i,this.key=n,this.O=s,this.subscribe=this.l,this.unsubscribe=this.u,i[n]instanceof Object&&(i[n]=t.ProxyObserver.Fs(i[n]).O)}Z(value,s){const i=this.raw[this.key];i!==value&&(this.raw[this.key]=value,this.m(value,i,s|t.LifecycleFlags.xs|t.LifecycleFlags.q))}Y(){return this.raw[this.key]}};Vt=i([subscriberCollection(t.MutationKind.g)],Vt),t.ProxyObserver=Rt=class{constructor(t){this.raw=t,this.O=new Proxy(t,this),Pt.set(t,this.O),this.Zi={}}static tn(t){if(void 0===t.sn){const s=Pt.get(t);return void 0===s?t:s}return t}static Rt(t){const s=t.sn;return void 0===s?t:s}static Fs(t,s){let i;if(void 0===t.sn){const s=Pt.get(t);i=void 0===s?new Rt(t):s.K}else i=t.K;if(1===arguments.length)return i;let n=i.Zi[s];if(void 0===n){const h=this.Rt(t);n=i.Zi[s]=new Vt(i.O,h,s)}return n}static in(t){return void 0!==t.sn}get(t,s,i){return"$observer"===s?this:"$raw"===s?t:t[s]}set(s,i,value,n){const h=s[i];return h!==value&&(Reflect.set(s,i,value,s),this.nn(value,h,i),this.m(i,value,h,t.LifecycleFlags.xs|t.LifecycleFlags.q)),1}deleteProperty(s,i){const n=s[i];return Reflect.deleteProperty(s,i)?(void 0!==n&&(this.nn(void 0,n,i),this.m(i,void 0,n,t.LifecycleFlags.xs|t.LifecycleFlags.q)),1):0}defineProperty(s,i,n){const h=s[i];return Reflect.defineProperty(s,i,n)?(n.value!==h&&(this.nn(n.value,h,i),this.m(i,n.value,h,t.LifecycleFlags.xs|t.LifecycleFlags.q)),1):0}apply(t,s,i){return Reflect.apply(t,t,i)}subscribe(t,s){if(1===arguments.length)this.l(t);else{let i=this.Zi[s];void 0===i&&(i=this.Zi[s]=new Vt(this.O,this.raw,s)),i.l(t)}}unsubscribe(t,s){if(1===arguments.length)this.u(t);else{const i=this.Zi[s];void 0!==i&&i.u(t)}}nn(s,i,n){const h=this.Zi[n];void 0!==h&&h.m(s,i,t.LifecycleFlags.xs|t.LifecycleFlags.q)}},t.ProxyObserver=Rt=i([subscriberCollection(t.MutationKind.O)],t.ProxyObserver);const Dt=Reflect.defineProperty,Lt={get:void 0,set:void 0,Bs:1,hn:1};t.SetterObserver=class{constructor(s,i,n){this.X=s&t.LifecycleFlags.Ns,this.G=i,this.J=n,s&t.LifecycleFlags.U&&(this.Y=this.en)}Y(){return this._}en(){return this.G[this.J]}Z(s,i){const n=this._;(n!==s||i&t.LifecycleFlags.U)&&(this._=s,i&t.LifecycleFlags.ut||this.m(s,n,this.X|i),this.W||(this.G[this.J]=s))}M(t){this.m(this.G[this.J],this._,this.X|t),v(this.G[this.J],t)}},t.SetterObserver=i([propertyObserver()],t.SetterObserver),(function(t){t[t.rn=250]="UndefinedScope",t[t.on=251]="NullScope",t[t.ln=252]="NilOverrideContext",t[t.cn=253]="NilParentScope"})($t||($t={}));class Bt{Fs(s,i,n){return void 0===this[n]&&(this[n]=new t.SetterObserver(s,i,n)),this[n]}}class BindingContext{constructor(t,value){if(this.un=1,void 0!==t)if(void 0!==value)this[t]=value;else for(const s in t)t.hasOwnProperty(s)&&(this[s]=t[s])}static create(s,i,value){const n=new BindingContext(i,value);return s&t.LifecycleFlags.xs?t.ProxyObserver.Fs(n).O:n}static get(s,name,i,n){if(void 0===s)throw kernel.Reporter.error(250);if(null===s)throw kernel.Reporter.error(251);let h=s.an;if(i>0){for(;i>0;){if(null===h.fn)return;i--,h=h.fn}return name in h?h:h.dn}for(;h&&!(name in h)&&!(h.dn&&name in h.dn);)h=h.fn;if(h)return name in h?h:h.dn;if(n&t.LifecycleFlags.Ui&&null!==s.ws){const h=this.get(s.ws,name,i,n&~t.LifecycleFlags.Ui|t.LifecycleFlags.Fi);if(null!==h)return h}return n&t.LifecycleFlags.Fi?null:s.dn||s.an}bn(t){return void 0===this.F&&(this.F=new Bt),this.F}}class Scope{constructor(t,s){this.dn=t,this.an=s,this.ws=null}static create(t,s,i){return new Scope(s,null==i?OverrideContext.create(t,s,i):i)}static pn(t,s){if(null==s)throw kernel.Reporter.error(252);return new Scope(s.dn,s)}static vn(t,s,i){if(null==s)throw kernel.Reporter.error(253);return new Scope(i,OverrideContext.create(t,i,s.an))}}class OverrideContext{constructor(t,s){this.un=1,this.dn=t,this.fn=s}static create(t,s,i){return new OverrideContext(s,void 0===i?null:i)}bn(){return void 0===this.F&&(this.F=new Bt),this.F}}const ISignaler=kernel.DI.wn("ISignaler").gn(t=>t.singleton(Nt));class Nt{constructor(){this.mn=Object.create(null)}yn(name,s){const i=this.mn[name];if(void 0!==i)for(const n of i.keys())n.j(void 0,void 0,s|t.LifecycleFlags.q)}Cn(name,t){const s=this.mn,i=s[name];void 0===i?s[name]=new Set([t]):i.add(t)}On(name,t){const s=this.mn[name];s&&s.delete(t)}}const BindingBehaviorResource={name:"binding-behavior",st(name){return`${this.name}:${name}`},jn(t){return t.kind===this},An(t,s){const i=s,n="string"==typeof t?{name:t}:t;return i.kind=BindingBehaviorResource,i.description=n,i.register=m,i}},ValueConverterResource={name:"value-converter",st(name){return`${this.name}:${name}`},jn(t){return t.kind===this},An(t,s){const i=s,n="string"==typeof t?{name:t}:t;return i.kind=ValueConverterResource,i.description=n,i.register=y,i}};(function(t){t[t.Tn=202]="NoLocator",t[t.Sn=203]="NoBehaviorFound",t[t.Rn=204]="BehaviorAlreadyApplied",t[t.$n=205]="NoConverterFound",t[t.In=206]="NoBinding",t[t.kn=207]="NotAFunction",t[t.Pn=208]="UnknownOperator",t[t.rn=250]="UndefinedScope",t[t.on=251]="NullScope"})(It||(It={}));class AccessThis{constructor(t=0){this.it=1793,this.assign=kernel.PLATFORM.Vn,this.connect=kernel.PLATFORM.Vn,this.Dn=t}evaluate(t,s,i){if(void 0===s)throw kernel.Reporter.error(250,this);if(null===s)throw kernel.Reporter.error(251,this);let n=s.an,h=this.Dn;for(;h--&&n;)n=n.fn;return 1>h&&n?n.dn:void 0}accept(t){return t.Ln(this)}}AccessThis.Bn=new AccessThis(0),AccessThis.Nn=new AccessThis(1);class AccessScope{constructor(name,t=0){this.it=10082,this.name=name,this.Dn=t}evaluate(t,s,i){return BindingContext.get(s,this.name,this.Dn,t)[this.name]}assign(t,s,i,value){const n=BindingContext.get(s,this.name,this.Dn,t);return n?n[this.name]=value:void 0}connect(t,s,i){const n=BindingContext.get(s,this.name,this.Dn,t);i.ct(t,n,this.name)}accept(t){return t.xn(this)}}class AccessMember{constructor(t,name){this.it=9323,this.object=t,this.name=name}evaluate(t,s,i){const n=this.object.evaluate(t,s,i);return null==n?n:n[this.name]}assign(t,s,i,value){let n=this.object.evaluate(t,s,i);return null!==n&&"object"==typeof n||this.object.assign(t,s,i,n={}),n[this.name]=value,value}connect(t,s,i){const n=this.object.evaluate(t,s,null);this.object.connect(t,s,i),n&&i.ct(t,n,this.name)}accept(t){return t.Fn(this)}}class CallScope{constructor(name,t,s=0){this.it=1448,this.assign=kernel.PLATFORM.Vn,this.name=name,this.Mn=t,this.Dn=s}evaluate(t,s,i){const n=C(t,s,i,this.Mn),h=BindingContext.get(s,this.name,this.Dn,t),e=O(t,h,this.name);if(e)return e.apply(h,n)}connect(t,s,i){const n=this.Mn;for(let h=0,e=n.length;e>h;++h)n[h].connect(t,s,i)}accept(t){return t.Un(this)}}class CallMember{constructor(t,name,s){this.it=1161,this.assign=kernel.PLATFORM.Vn,this.object=t,this.name=name,this.Mn=s}evaluate(t,s,i){const n=this.object.evaluate(t,s,i),h=C(t,s,i,this.Mn),e=O(t,n,this.name);if(e)return e.apply(n,h)}connect(s,i,n){const h=this.object.evaluate(s,i,null);if(this.object.connect(s,i,n),O(s&~t.LifecycleFlags.ht,h,this.name)){const t=this.Mn;for(let h=0,e=t.length;e>h;++h)t[h].connect(s,i,n)}}accept(t){return t.En(this)}}class PrimitiveLiteral{constructor(value){this.it=17925,this.assign=kernel.PLATFORM.Vn,this.connect=kernel.PLATFORM.Vn,this.value=value}evaluate(t,s,i){return this.value}accept(t){return t.zn(this)}}PrimitiveLiteral.qn=new PrimitiveLiteral(void 0),PrimitiveLiteral.Qn=new PrimitiveLiteral(null),PrimitiveLiteral.Hn=new PrimitiveLiteral(1),PrimitiveLiteral.Kn=new PrimitiveLiteral(0),PrimitiveLiteral.Wn=new PrimitiveLiteral("");class ArrayLiteral{constructor(t){this.it=17955,this.assign=kernel.PLATFORM.Vn,this.elements=t}evaluate(t,s,i){const n=this.elements,h=n.length,e=Array(h);for(let r=0;h>r;++r)e[r]=n[r].evaluate(t,s,i);return e}connect(t,s,i){const n=this.elements;for(let h=0,e=n.length;e>h;++h)n[h].connect(t,s,i)}accept(t){return t._n(this)}}ArrayLiteral.Wn=new ArrayLiteral(kernel.PLATFORM.Gn);class ObjectLiteral{constructor(t,s){this.it=17956,this.assign=kernel.PLATFORM.Vn,this.keys=t,this.values=s}evaluate(t,s,i){const n={},h=this.keys,e=this.values;for(let r=0,o=h.length;o>r;++r)n[h[r]]=e[r].evaluate(t,s,i);return n}connect(t,s,i){const n=this.values;for(let h=0,e=this.keys.length;e>h;++h)n[h].connect(t,s,i)}accept(t){return t.Jn(this)}}ObjectLiteral.Wn=new ObjectLiteral(kernel.PLATFORM.Gn,kernel.PLATFORM.Gn);class Template{constructor(t,s){this.it=17958,this.assign=kernel.PLATFORM.Vn,this.Xn=t,this.nt=void 0===s?kernel.PLATFORM.Gn:s}evaluate(t,s,i){const n=this.nt,h=this.Xn;let e=h[0];for(let r=0,o=n.length;o>r;++r)e+=n[r].evaluate(t,s,i),e+=h[r+1];return e}connect(t,s,i){const n=this.nt;for(let h=0,e=n.length;e>h;++h)n[h].connect(t,s,i),h++}accept(t){return t.Yn(this)}}Template.Wn=new Template([""]);const xt={}.toString,Ft=t.LifecycleFlags.xs|t.LifecycleFlags.Mi,Mt={Zn(s,i,n){if((s&Ft)===Ft){const s=t.ProxyObserver.Rt(i),h=s.length;let e,r=0;for(;h>r;++r)(e=s[r])instanceof Object&&(e=s[r]=t.ProxyObserver.Fs(e).O),n(s,r,e)}else for(let t=0,s=i.length;s>t;++t)n(i,t,i[t])},th(s,i,n){const h=Array(i.size);let e=-1;for(const t of i.entries())h[++e]=t;Mt["Zn"](s&~t.LifecycleFlags.Mi,h,n)},sh(s,i,n){const h=Array(i.size);let e=-1;for(const t of i.keys())h[++e]=t;Mt["Zn"](s&~t.LifecycleFlags.Mi,h,n)},ih(s,i,n){const h=Array(i);for(let t=0;i>t;++t)h[t]=t;Mt["Zn"](s&~t.LifecycleFlags.Mi,h,n)},nh(t,s,i){},hh(t,s,i){}},Ut={Zn:t=>t.length,th:t=>t.size,sh:t=>t.size,ih:t=>t,nh:()=>0,hh:()=>0},IRenderable=kernel.DI.wn("IRenderable").eh(),IViewFactory=kernel.DI.wn("IViewFactory").eh(),Et=Object.freeze(Object.create(null)),ILifecycle=kernel.DI.wn("ILifecycle").gn(t=>t.singleton(zt));class zt{constructor(){this.rh=0,this.oh=0,this.lh=0,this.uh=0,this.ah=0,this.fh=this,this.dh=this,this.bh=this,this.ph=this,this.vh=this,this.gh=this,this.wh=this,this.mh=this,this.yh=this,this.Ch=this,this.Oh=this,this.jh=this,this.Ah=this,this.Th=this,this.Sh=this,this.Rh=this,this.$h=this,this.Ih=this,this.kh=null,this.Ph=Promise.resolve(),this.Vh=0,this.Dh=0,this.Lh=0,this.Bh=0,this.Nh=0,this.xh=0,this.Fh=0,this.Mh=0,this.Uh=0,this.Eh=0,this.pt=Et,this.flush=kernel.PLATFORM.Vn,this.zh=Et,this.connect=kernel.PLATFORM.Vn,this.qh=Et,this.bound=kernel.PLATFORM.Vn,this.Qh=Et,this.Hh=kernel.PLATFORM.Vn,this.Kh=Et,this.Wh=kernel.PLATFORM.Vn,this._h=Et,this.Gh=kernel.PLATFORM.Vn,this.Jh=Et,this.Xh=kernel.PLATFORM.Vn,this.Yh=Et,this.ds=kernel.PLATFORM.Vn,this.Zh=Et,this.te=kernel.PLATFORM.Vn,this.se=null}static register(t){return kernel.Registration.singleton(ILifecycle,this).register(t)}ie(t){null===this.se&&(this.se=new AggregateLifecycleTask),this.se.ne(t)}he(t){null!==this.se&&(this.se===t?this.se=null:this.se.ee(t))}A(s){return this.fh===this&&(this.kh=this.Ph.then(()=>{this.re(t.LifecycleFlags.ki)})),null===s.pt&&(s.pt=Et,this.dh.pt=s,this.dh=s,++this.Vh),this.kh}re(s){for(s|=t.LifecycleFlags.Pi;this.Vh>0;){let i,n=this.fh.pt;this.fh=this.dh=this,this.Vh=0;do{i=n.pt,n.pt=null,n.flush(s),n=i}while(n!==Et);if(s&t.LifecycleFlags.ft)break}}bs(){++this.rh}ps(t){null===t.qh&&(t.qh=Et,this.gh.qh=t,this.gh=t,++this.Bh)}oe(t){null===t.zh&&(t.zh=Et,this.ph.zh=t,this.ph=t,++this.Dh)}le(t){if(this.Dh>0){this.Dh=0;let s,i=this.bh.zh;this.bh=this.ph=this;do{i.connect(t),s=i.zh,i.zh=null,i=s}while(i!==Et)}}gs(t){if(0==--this.rh)return null===this.se||this.se.done?(this.ce(t),LifecycleTask.done):(this.se.ue=this,this.se)}ce(s){for(s&t.LifecycleFlags.Di&&this.re(s|t.LifecycleFlags.Pi);this.Bh>0;){this.Bh=0;let t,i=this.vh.qh;this.vh=this.gh=this;do{i.bound(s),t=i.qh,i.qh=null,i=t}while(i!==Et)}}Os(){++this.ah}As(t){null===t.Zh&&(t.Zh=Et,this.Ih.Zh=t,this.Ih=t,++this.Eh)}Ss(t){if(0==--this.ah)return null===this.se||this.se.done?(this.ae(t),LifecycleTask.done):(this.se.ue=this,this.se)}ae(t){for(;this.Eh>0;){this.Eh=0;let s,i=this.$h.Zh;this.$h=this.Ih=this;do{i.te(t),s=i.Zh,i.Zh=null,i=s}while(i!==Et)}}Ft(){++this.lh}Kt(t){null===t.Qh&&(t.Qh=Et,this.mh.Qh=t,this.mh=t,++this.Nh)}Et(t){null===t.Kh&&(t.Kh=Et,this.Ch.Kh=t,this.Ch=t,++this.xh)}zt(t){if(0==--this.lh)return null===this.se||this.se.done?(this.fe(t),LifecycleTask.done):(this.se.ue=this,this.se)}fe(s){if(this.re(s|t.LifecycleFlags.Pi),this.Nh>0){this.Nh=0;let t,i=this.wh.Qh;this.wh=this.mh=this;do{i.Hh(s),t=i.Qh,i.Qh=null,i=t}while(i!==Et)}if(this.le(t.LifecycleFlags.ht),this.xh>0){this.xh=0;let t,i=this.yh.Kh;this.yh=this.Ch=this;do{i.Wh(s),t=i.Kh,i.Kh=null,i=t}while(i!==Et)}}Wt(){++this.uh}ts(t){if(null===t._h&&(t._h=Et,this.jh._h=t,this.jh=t,++this.Fh),null!==t.Qh){let s=this.wh,i=s.Qh;for(;i!==t;)i=(s=i).Qh;s.Qh=i.Qh,i.Qh=null,this.mh===i&&(this.mh=this),--this.Nh}}Jt(t){null===t.Jh&&(t.Jh=Et,this.Th.Jh=t,this.Th=t,++this.Mh)}de(t){null===t.Yh&&(t.Yh=Et,this.Rh.Yh=t,this.Rh=t,++this.Uh)}Xt(t){if(0==--this.uh)return null===this.se||this.se.done?(this.be(t),LifecycleTask.done):(this.se.ue=this,this.se)}be(s){if(this.re(s|t.LifecycleFlags.H|t.LifecycleFlags.ft),this.Fh>0){this.Fh=0;let t,i=this.Oh._h;this.Oh=this.jh=this;do{i.Gh(s),t=i._h,i._h=null,i=t}while(i!==Et)}if(this.Mh>0){this.Mh=0;let t,i=this.Ah.Jh;this.Ah=this.Th=this;do{i.Xh(s),t=i.Jh,i.Jh=null,i=t}while(i!==Et)}if(this.Uh>0){this.Os(),this.Uh=0;let t,i=this.Sh.Yh;this.Sh=this.Rh=this;do{i.ds(s),t=i.Yh,i.Yh=null,i=t}while(i!==Et);this.Ss(s)}}}class CompositionCoordinator{constructor($lifecycle){this.$lifecycle=$lifecycle,this.pe=kernel.PLATFORM.Vn,this.currentView=null,this.hi=0,this.ii=0,this.ve=null,this.ge=LifecycleTask.done}static register(t){return kernel.Registration.transient(this,this).register(t,this)}we(value,t){this.ge.done?value instanceof Promise?(this.me(new qt(this,value)),this.ye()):this.Ce(value,t):(value instanceof Promise?this.me(new qt(this,value)):this.me(value),this.ge.Oe()&&this.ge.cancel())}vs(t,s){this.scope=s,this.ii=1,null!==this.currentView&&this.currentView.ys(t,s)}Ut(t){this.hi=1,null!==this.currentView&&this.currentView.Qt(t)}Gt(t){this.hi=0,null!==this.currentView&&this.currentView.ns(t)}Ts(t){this.ii=0,null!==this.currentView&&this.currentView.ds(t)}es(t){this.currentView=null}me(t){null===this.ve&&(this.ve=[]),this.ve.push(t)}Ce(t,s){if(this.currentView===t)return;const $lifecycle=this.$lifecycle,i=new AggregateLifecycleTask;let n,h=this.currentView;null===h?n=LifecycleTask.done:($lifecycle.de(h),$lifecycle.Wt(),h.ns(s),n=$lifecycle.Xt(s)),i.ne(n),null===(h=this.currentView=t)?n=LifecycleTask.done:(this.ii&&($lifecycle.bs(),h.ys(s,this.scope),$lifecycle.gs(s)),this.hi?($lifecycle.Ft(),h.Qt(s),n=$lifecycle.zt(s)):n=LifecycleTask.done),i.ne(n),i.done?(this.ge=LifecycleTask.done,this.pe()):(this.ge=i,this.ge.je().then(()=>{this.pe(),this.ye()}).catch(t=>{throw t}))}ye(){if(null!==this.ve&&this.ve.length>0){const s=this.ve.pop();this.ve.length=0,qt.is(s)?this.ge=s.start():this.Ce(s,t.LifecycleFlags.xi)}else this.ge=LifecycleTask.done}}CompositionCoordinator.inject=[ILifecycle];const LifecycleTask={done:{done:1,Oe:()=>0,cancel(){},je:()=>Promise.resolve()}};class AggregateLifecycleTask{constructor(){this.done=1,this.ue=null,this.resolve=null,this.Ae=[],this.Te=null}ne(t){t.done||(this.done=0,this.Ae.push(t),t.je().then(()=>{this.Se()}).catch(t=>{throw t}))}ee(t){if(t.done){const s=this.Ae.indexOf(t);-1!==s&&this.Ae.splice(s,1)}0===this.Ae.length&&null!==this.ue&&(this.ue.he(this),this.ue=null)}Oe(){return this.done?0:this.Ae.every(t=>t.Oe())}cancel(){this.Oe()&&(this.Ae.forEach(t=>{t.cancel()}),this.done=0)}je(){return null===this.Te&&(this.Te=this.done?Promise.resolve():new Promise(t=>this.resolve=t)),this.Te}Se(){this.done||this.Ae.every(t=>t.done)&&this.complete(1)}complete(s){this.done=1,s&&null!==this.ue&&(this.ue.be(t.LifecycleFlags.xi),this.ue.ae(t.LifecycleFlags.xi),this.ue.ce(t.LifecycleFlags.xi),this.ue.fe(t.LifecycleFlags.xi)),this.ue.he(this),null!==this.resolve&&this.resolve()}}class qt{constructor(t,s){this.Re=t,this.done=0,this.$e=0,this.Ph=s}static is(t){return"start"in t}start(){return this.$e?LifecycleTask.done:(this.Ph=this.Ph.then(t=>(this.Ie(t),t)),this)}Oe(){return!this.done}cancel(){this.Oe()&&(this.$e=1)}je(){return this.Ph}Ie(value){this.$e||(this.done=1,this.Re.we(value,t.LifecycleFlags.xi))}}const Qt=[],Ht=[];let Kt=-1;j(-1);const{oneTime,Ws:Wt,_s:_t}=t.BindingMode,Gt=Wt|oneTime;t.Binding=class{constructor(s,i,n,mode,h,e){this.Cs=null,this.$s=null,this.$state=0,this.$lifecycle=e.get(ILifecycle),this.zh=null,this.$scope=null,this.ke=e,this.mode=mode,this.ot=h,this.Pe=s,this.target=i,this.Ve=n,this.X=t.LifecycleFlags.ti}De(value,s){this.targetObserver.Z(value,(s|=this.X)|t.LifecycleFlags.q),s&t.LifecycleFlags.U&&this.targetObserver.M(s)}Le(value,s){this.Pe.assign((s|=this.X)|t.LifecycleFlags.Ii,this.$scope,this.ke,value)}j(s,i,n){if(2&this.$state){if(n|=this.X,this.mode===t.BindingMode._s&&(n&=~t.LifecycleFlags.q,n|=t.LifecycleFlags.Ii),n&t.LifecycleFlags.q){const t=this.targetObserver.Y();return(10082!==this.Pe.it||this.et>1)&&(s=this.Pe.evaluate(n,this.$scope,this.ke)),s!==t&&this.De(s,n),void(0==(this.mode&oneTime)&&(this.version++,this.Pe.connect(n,this.$scope,this),this.unobserve(0)))}if(!(n&t.LifecycleFlags.Ii))throw kernel.Reporter.error(15,t.LifecycleFlags[n]);s!==this.Pe.evaluate(n,this.$scope,this.ke)&&this.Le(s,n)}}ys(s,i){if(2&this.$state){if(this.$scope===i)return;this.ds(s|t.LifecycleFlags.ut)}this.$state|=1,this.X=s&t.LifecycleFlags.Ns,this.$scope=i;let n=this.Pe;hasBind(n)&&n.bind(s,i,this);let targetObserver=this.targetObserver;targetObserver||(targetObserver=this.targetObserver=this.mode&_t?this.ot.rt(s,this.target,this.Ve):this.ot.Be(s,this.target,this.Ve)),targetObserver.bind&&targetObserver.bind(s),n=this.Pe,this.mode&Gt&&this.De(n.evaluate(s,i,this.ke),s),this.mode&Wt&&n.connect(s,i,this),this.mode&_t&&targetObserver.subscribe(this),this.$state|=2,this.$state&=-2}ds(s){2&this.$state&&(this.$state|=64,this.X=t.LifecycleFlags.ti,hasUnbind(this.Pe)&&this.Pe.Ne(s,this.$scope,this),this.$scope=null,this.targetObserver.Ne&&this.targetObserver.Ne(s),this.targetObserver.unsubscribe&&this.targetObserver.unsubscribe(this),this.unobserve(1),this.$state&=-67)}connect(s){2&this.$state&&this.Pe.connect((s|=this.X)|t.LifecycleFlags.ht,this.$scope,this)}M(t){2&this.$state&&this.targetObserver.M(t|this.X)}},t.Binding=i([connectable()],t.Binding);class Call{constructor(s,i,n,h,e){this.Cs=null,this.$s=null,this.$state=0,this.ke=e,this.Pe=s,this.targetObserver=h.rt(t.LifecycleFlags.ti,i,n)}xe(s){const i=this.$scope.an;Object.assign(i,s);const n=this.Pe.evaluate(t.LifecycleFlags.ht,this.$scope,this.ke);for(const t in s)Reflect.deleteProperty(i,t);return n}ys(s,i){if(2&this.$state){if(this.$scope===i)return;this.ds(s|t.LifecycleFlags.ut)}this.$state|=1,this.$scope=i,hasBind(this.Pe)&&this.Pe.bind(s,i,this),this.targetObserver.Z(t=>this.xe(t),s),this.$state|=2,this.$state&=-2}ds(t){2&this.$state&&(this.$state|=64,hasUnbind(this.Pe)&&this.Pe.Ne(t,this.$scope,this),this.$scope=null,this.targetObserver.Z(null,t),this.$state&=-67)}ct(t,s,i){}j(t,s,i){}}const IExpressionParser=kernel.DI.wn("IExpressionParser").gn(t=>t.singleton(Jt));class Jt{constructor(){this.Fe=Object.create(null),this.Me=Object.create(null),this.Ue=Object.create(null)}parse(t,s){switch(s){case 2048:{let i=this.Ue[t];return void 0===i&&(i=this.Ue[t]=this.Ee(t,s)),i}case 539:{let i=this.Me[t];return void 0===i&&(i=this.Me[t]=this.Ee(t,s)),i}default:{if(0===t.length&&55&s)return PrimitiveLiteral.Wn;let i=this.Fe[t];return void 0===i&&(i=this.Fe[t]=this.Ee(t,s)),i}}}cache(t){const{Me:s,Fe:i,Ue:n}=this;for(const h in t){const e=t[h];switch(e.it){case 24:n[h]=e;break;case 6199:s[h]=e;break;default:i[h]=e}}}Ee(t,s){try{const parts=t.split("."),s=parts[0];let i;i=s.endsWith("()")?new CallScope(s.replace("()",""),kernel.PLATFORM.Gn):new AccessScope(parts[0]);let n=1;for(;parts.length>n;){const t=parts[n];i=t.endsWith("()")?new CallMember(i,t.replace("()",""),kernel.PLATFORM.Gn):new AccessMember(i,parts[n]),n++}return i}catch(t){throw kernel.Reporter.error(3,t)}}}(BindingType=t.BindingType||(t.BindingType={}))[BindingType.qi=0]="None",BindingType[BindingType.Interpolation=2048]="Interpolation",BindingType[BindingType.ze=1280]="IsRef",BindingType[BindingType.qe=512]="IsIterator",BindingType[BindingType.Qe=256]="IsCustom",BindingType[BindingType.He=128]="IsFunction",BindingType[BindingType.Ke=64]="IsEvent",BindingType[BindingType.We=32]="IsProperty",BindingType[BindingType._e=16]="IsCommand",BindingType[BindingType.Ge=48]="IsPropertyCommand",BindingType[BindingType.Je=80]="IsEventCommand",BindingType[BindingType.Xe=6]="DelegationStrategyDelta",BindingType[BindingType.Ye=15]="Command",BindingType[BindingType.Ze=49]="OneTimeCommand",BindingType[BindingType.tr=50]="ToViewCommand",BindingType[BindingType.sr=51]="FromViewCommand",BindingType[BindingType.ir=52]="TwoWayCommand",BindingType[BindingType.nr=53]="BindCommand",BindingType[BindingType.hr=86]="TriggerCommand",BindingType[BindingType.er=87]="CaptureCommand",BindingType[BindingType.rr=88]="DelegateCommand",BindingType[BindingType.or=153]="CallCommand",BindingType[BindingType.lr=26]="OptionsCommand",BindingType[BindingType.cr=539]="ForCommand",BindingType[BindingType.ur=284]="CustomCommand";const{Ws:Xt,oneTime:Yt}=t.BindingMode;class MultiInterpolationBinding{constructor(s,i,n,h,mode,e){this.Cs=null,this.$s=null,this.$state=0,this.$scope=null,this.ar=i,this.ke=e,this.mode=mode,this.ot=s,this.target=n,this.Ve=h;const r=i.nt,parts=this.parts=Array(r.length);for(let o=0,l=r.length;l>o;++o)parts[o]=new t.InterpolationBinding(r[o],i,n,h,mode,s,e,0===o)}ys(t,s){if(2&this.$state){if(this.$scope===s)return;this.ds(t)}this.$state|=2,this.$scope=s;const parts=this.parts;for(let i=0,n=parts.length;n>i;++i)parts[i].ys(t,s)}ds(t){if(!(2&this.$state))return;this.$state&=-3,this.$scope=null;const parts=this.parts;for(let s=0,i=parts.length;i>s;++s)parts[s].ds(t)}}t.InterpolationBinding=class{constructor(s,i,n,h,mode,e,r,o){this.$state=0,this.ar=i,this.dr=o,this.mode=mode,this.ke=r,this.ot=e,this.Pe=s,this.target=n,this.Ve=h,this.targetObserver=e.Be(t.LifecycleFlags.ti,n,h)}De(value,s){this.targetObserver.Z(value,s|t.LifecycleFlags.q)}j(t,s,i){if(!(2&this.$state))return;const n=this.targetObserver.Y(),h=this.ar.evaluate(i,this.$scope,this.ke);h!==n&&this.De(h,i),0==(this.mode&Yt)&&(this.version++,this.Pe.connect(i,this.$scope,this),this.unobserve(0))}ys(t,s){if(2&this.$state){if(this.$scope===s)return;this.ds(t)}this.$state|=2,this.$scope=s;const i=this.Pe;i.bind&&i.bind(t,s,this),this.dr&&this.De(this.ar.evaluate(t,s,this.ke),t),this.mode&Xt&&i.connect(t,s,this)}ds(t){if(!(2&this.$state))return;this.$state&=-3;const s=this.Pe;s.Ne&&s.Ne(t,this.$scope,this),this.$scope=null,this.unobserve(1)}},t.InterpolationBinding=i([connectable()],t.InterpolationBinding),t.LetBinding=class{constructor(t,s,i,n,toViewModel=0){this.Cs=null,this.$s=null,this.$state=0,this.$lifecycle=n.get(ILifecycle),this.$scope=null,this.ke=n,this.ot=i,this.Pe=t,this.target=null,this.Ve=s,this.toViewModel=toViewModel}j(s,i,n){if(2&this.$state){if(!(n&t.LifecycleFlags.q))throw kernel.Reporter.error(15,n);{const{target:t,Ve:s}=this,i=t[s],h=this.Pe.evaluate(n,this.$scope,this.ke);h!==i&&(t[s]=h)}}}ys(s,i){if(2&this.$state){if(this.$scope===i)return;this.ds(s|t.LifecycleFlags.ut)}this.$state|=1,this.$scope=i,this.target=this.toViewModel?i.dn:i.an;const n=this.Pe;n.bind&&n.bind(s,i,this),this.target[this.Ve]=this.Pe.evaluate(t.LifecycleFlags.ut,i,this.ke),this.Pe.connect(s,i,this),this.$state|=2,this.$state&=-2}ds(t){if(!(2&this.$state))return;this.$state|=64;const s=this.Pe;s.Ne&&s.Ne(t,this.$scope,this),this.$scope=null,this.unobserve(1),this.$state&=-67}},t.LetBinding=i([connectable()],t.LetBinding);class Ref{constructor(t,s,i){this.Cs=null,this.$s=null,this.$state=0,this.ke=i,this.Pe=t,this.target=s}ys(s,i){if(2&this.$state){if(this.$scope===i)return;this.ds(s|t.LifecycleFlags.ut)}this.$state|=1,this.$scope=i,hasBind(this.Pe)&&this.Pe.bind(s,i,this),this.Pe.assign(s,this.$scope,this.ke,this.target),this.$state|=2,this.$state&=-2}ds(t){if(!(2&this.$state))return;this.$state|=64,this.Pe.evaluate(t,this.$scope,this.ke)===this.target&&this.Pe.assign(t,this.$scope,this.ke,null);const s=this.Pe;hasUnbind(s)&&s.Ne(t,this.$scope,this),this.$scope=null,this.$state&=-67}ct(t,s,i){}j(t,s,i){}}t.CollectionLengthObserver=class{constructor(t,s){this.G=t,this.J=s,this._=t[s]}Y(){return this.G[this.J]}bt(t){this.G[this.J]=t}M(s){const i=this.G[this.J],n=this._;n!==i&&(this.G[this.J]=i,this._=i,this.m(i,n,s|t.LifecycleFlags.q))}subscribe(t){this.l(t)}unsubscribe(t){this.u(t)}},t.CollectionLengthObserver=i([targetObserver()],t.CollectionLengthObserver);const Zt=Array.prototype,ts=Zt.push,ss=Zt.unshift,is=Zt.pop,ns=Zt.shift,hs=Zt.splice,es=Zt.reverse,rs=Zt.sort,os={push:ts,unshift:ss,pop:is,shift:ns,splice:hs,reverse:es,sort:rs},ls=["push","unshift","pop","shift","splice","reverse","sort"],cs={push(){let s=this;void 0!==s.sn&&(s=s.sn);const i=s.K;if(void 0===i)return ts.apply(s,arguments);const n=s.length,h=arguments.length;if(0===h)return n;s.length=i.vt.length=n+h;let e=n;for(;s.length>e;)s[e]=arguments[e-n],i.vt[e]=-2,e++;return i.m("push",arguments,i.X|t.LifecycleFlags.Si),s.length},unshift(){let s=this;void 0!==s.sn&&(s=s.sn);const i=s.K;if(void 0===i)return ss.apply(s,arguments);const n=arguments.length,h=Array(n);let e=0;for(;n>e;)h[e++]=-2;ss.apply(i.vt,h);const r=ss.apply(s,arguments);return i.m("unshift",arguments,i.X|t.LifecycleFlags.Si),r},pop(){let s=this;void 0!==s.sn&&(s=s.sn);const i=s.K;if(void 0===i)return is.call(s);const n=i.vt,h=is.call(s),e=n.length-1;return n[e]>-1&&n.yt.push(n[e]),is.call(n),i.m("pop",arguments,i.X|t.LifecycleFlags.Si),h},shift(){let s=this;void 0!==s.sn&&(s=s.sn);const i=s.K;if(void 0===i)return ns.call(s);const n=i.vt,h=ns.call(s);return n[0]>-1&&n.yt.push(n[0]),ns.call(n),i.m("shift",arguments,i.X|t.LifecycleFlags.Si),h},splice(s,i){let n=this;void 0!==n.sn&&(n=n.sn);const h=n.K;if(void 0===h)return hs.apply(n,arguments);const e=h.vt;if(i>0){let t=isNaN(s)?0:s;const to=t+i;for(;to>t;)e[t]>-1&&e.yt.push(e[t]),t++}const r=arguments.length;if(r>2){const t=r-2,n=Array(t);let h=0;for(;t>h;)n[h++]=-2;hs.call(e,s,i,...n)}else 2===r&&hs.call(e,s,i);const o=hs.apply(n,arguments);return h.m("splice",arguments,h.X|t.LifecycleFlags.Si),o},reverse(){let s=this;void 0!==s.sn&&(s=s.sn);const i=s.K;if(void 0===i)return es.call(s),this;const n=s.length,h=n/2|0;let e=0;for(;e!==h;){const t=n-e-1,h=s[e],r=i.vt[e],o=i.vt[t];s[e]=s[t],i.vt[e]=o,s[t]=h,i.vt[t]=r,e++}return i.m("reverse",arguments,i.X|t.LifecycleFlags.Si),this},sort(s){let i=this;void 0!==i.sn&&(i=i.sn);const n=i.K;if(void 0===n)return rs.call(i,s),this;const h=i.length;if(2>h)return this;U(i,n.vt,0,h,F);let e=0;for(;h>e&&void 0!==i[e];)e++;return void 0!==s&&"function"==typeof s||(s=x),U(i,n.vt,0,e,s),n.m("sort",arguments,n.X|t.LifecycleFlags.Si),this}},us={br:1,Bs:0,hn:1},def=Reflect.defineProperty;for(const t of ls)def(cs[t],"observing",{value:1,br:0,hn:0,Bs:0});enableArrayObservation(),t.ArrayObserver=class{constructor(s,i,n){this.T=i,n.K=this,this.C=n,this.flags=s&t.LifecycleFlags.Ns,this.wt()}M(t){const s=this.C,i=s.length;let n=0;for(;i>n;++n)v(s[n],t)}},t.ArrayObserver=i([collectionObserver(9)],t.ArrayObserver);const as=Map.prototype,fs=as.set,ds=as.clear,bs=as.delete,ps={set:fs,clear:ds,delete:bs},vs=["set","clear","delete"],gs={set(s,value){let i=this;void 0!==i.sn&&(i=i.sn);const n=i.K;if(void 0===n)return fs.call(i,s,value),this;const h=i.size;if(fs.call(i,s,value),i.size===h){let t=0;for(const h of i.entries()){if(h[0]===s)return h[1]!==value&&(n.vt[t]=-2),this;t++}return this}return n.vt[h]=-2,n.m("set",arguments,n.X|t.LifecycleFlags.Si),this},clear(){let s=this;void 0!==s.sn&&(s=s.sn);const i=s.K;if(void 0===i)return ds.call(s);if(s.size>0){const n=i.vt;let h=0;for(const t of s.keys())n[h]>-1&&n.yt.push(n[h]),h++;ds.call(s),n.length=0,i.m("clear",arguments,i.X|t.LifecycleFlags.Si)}},delete(value){let s=this;void 0!==s.sn&&(s=s.sn);const i=s.K;if(void 0===i)return bs.call(s,value);if(0===s.size)return 0;let n=0;const h=i.vt;for(const t of s.keys()){if(t===value)return h[n]>-1&&h.yt.push(h[n]),h.splice(n,1),bs.call(s,value);n++}return i.m("delete",arguments,i.X|t.LifecycleFlags.Si),0}},ws={br:1,Bs:0,hn:1},ms=Reflect.defineProperty;for(const t of vs)ms(gs[t],"observing",{value:1,br:0,hn:0,Bs:0});enableMapObservation(),t.MapObserver=class{constructor(s,i,n){this.T=i,n.K=this,this.C=n,this.flags=s&t.LifecycleFlags.Ns,this.wt()}M(t){this.C.forEach((value,s)=>{v(value,t),v(s,t)})}},t.MapObserver=i([collectionObserver(6)],t.MapObserver);const ys=Set.prototype,Cs=ys.add,Os=ys.clear,js=ys.delete,As={add:Cs,clear:Os,delete:js},Ts=["add","clear","delete"],Ss={add(value){let s=this;void 0!==s.sn&&(s=s.sn);const i=s.K;if(void 0===i)return Cs.call(s,value),this;const n=s.size;return Cs.call(s,value),s.size===n?this:(i.vt[n]=-2,i.m("add",arguments,i.X|t.LifecycleFlags.Si),this)},clear(){let s=this;void 0!==s.sn&&(s=s.sn);const i=s.K;if(void 0===i)return Os.call(s);if(s.size>0){const n=i.vt;let h=0;for(const t of s.keys())n[h]>-1&&n.yt.push(n[h]),h++;Os.call(s),n.length=0,i.m("clear",arguments,i.X|t.LifecycleFlags.Si)}},delete(value){let s=this;void 0!==s.sn&&(s=s.sn);const i=s.K;if(void 0===i)return js.call(s,value);if(0===s.size)return 0;let n=0;const h=i.vt;for(const t of s.keys()){if(t===value)return h[n]>-1&&h.yt.push(h[n]),h.splice(n,1),js.call(s,value);n++}return i.m("delete",arguments,i.X|t.LifecycleFlags.Si),0}},Rs={br:1,Bs:0,hn:1},$s=Reflect.defineProperty;for(const t of Ts)$s(Ss[t],"observing",{value:1,br:0,hn:0,Bs:0});enableSetObservation(),t.SetObserver=class{constructor(s,i,n){this.T=i,n.K=this,this.C=n,this.flags=s&t.LifecycleFlags.Ns,this.wt()}M(t){this.C.forEach((value,s)=>{v(s,t)})}},t.SetObserver=i([collectionObserver(7)],t.SetObserver);const Is={pr:0,vr:0};t.CustomSetterObserver=class{constructor(t,s,i){this.G=t,this.J=s,this._=this.oldValue=void 0,this.gr=i,this.W=0}Z(s){this.gr.set.call(this.G,s),this._!==s&&(this.oldValue=this._,this._=s,this.m(s,this.oldValue,t.LifecycleFlags.q))}subscribe(t){this.W||this.wr(),this.l(t)}unsubscribe(t){this.u(t)}wr(){this.W=1,this._=this.G[this.J],Reflect.defineProperty(this.G,this.J,{set:t=>{this.Z(t)}})}},t.CustomSetterObserver=i([subscriberCollection(t.MutationKind.g)],t.CustomSetterObserver),t.GetterObserver=class{constructor(t,s,i,n,h,e,r){this.G=i,this.J=n,this.mr=0,this._=this.oldValue=void 0,this.yr=[],this.Cr=[],this.Or=s,this.jr=0,this.gr=h,this.O=new Proxy(i,(function t(s,i,n){return{get(h,e,r){if(n.Ar(e))return Reflect.get(h,e,r);switch(ks.call(h)){case"[object Array]":if(n.Tr(i.Sr(s,h)),"length"===e)return Reflect.get(h,e,h);case"[object Map]":if(n.Tr(i.Rr(s,h)),"size"===e)return Reflect.get(h,e,h);case"[object Set]":if(n.Tr(i.$r(s,h)),"size"===e)return Reflect.get(h,e,h);default:n.Ir(i.rt(s,h,e))}return(function(s,i,n,h,e){const value=Reflect.get(i,n,i);return"function"==typeof value?i[n].bind(i):"object"!=typeof value||null===value?value:new Proxy(value,t(s,h,e))})(s,h,e,i,n)}}})(t,e,this)),Reflect.defineProperty(i,n,{get:()=>this.Y()})}Ir(t){-1===this.yr.indexOf(t)&&this.yr.push(t)}Tr(t){-1===this.Cr.indexOf(t)&&this.Cr.push(t)}Y(){return this._=0===this.jr||this.mr?Reflect.apply(this.gr.get,this.O,kernel.PLATFORM.Gn):Reflect.apply(this.gr.get,this.G,kernel.PLATFORM.Gn),this._}subscribe(t){this.l(t),1==++this.jr&&this.kr(1)}unsubscribe(t){this.u(t),0==--this.jr&&this.Pr()}j(){const s=this._,i=this.kr(0);s!==i&&this.m(i,s,t.LifecycleFlags.q)}N(){const s=this._,i=this.kr(0);s!==i&&this.m(i,s,t.LifecycleFlags.H|t.LifecycleFlags.q)}kr(t){const s=!this.Or.pr||t;return s&&(this.Pr(),this.mr=1),this._=this.Y(),s&&(this.yr.forEach(t=>{t.subscribe(this)}),this.Cr.forEach(t=>{t.Tt(this)}),this.mr=0),this._}Ar(t){return!this.mr||"$observers"===t}Pr(){this.yr.forEach(t=>{t.unsubscribe(this)}),this.yr.length=0,this.Cr.forEach(t=>{t.St(this)}),this.Cr.length=0}},t.GetterObserver=i([subscriberCollection(t.MutationKind.g)],t.GetterObserver);const ks={}.toString,IDirtyChecker=kernel.DI.wn("IDirtyChecker").gn(t=>t.singleton(Ps)),DirtyCheckSettings={Vr:6,disabled:0,warn:1,Dr:0,Lr(){this.Vr=6,this.disabled=0,this.warn=1,this.Dr=0}};class Ps{constructor(){this.Br=0,this.Nr=[]}xr(s,i){if(DirtyCheckSettings.Dr)throw kernel.Reporter.error(800);return DirtyCheckSettings.warn&&kernel.Reporter.write(801),new t.DirtyCheckProperty(this,s,i)}Fr(t){this.Nr.push(t),1===this.Nr.length&&kernel.PLATFORM.Mr.add(this.Ur,this)}removeProperty(t){this.Nr.splice(this.Nr.indexOf(t),1),0===this.Nr.length&&kernel.PLATFORM.Mr.remove(this.Ur,this)}Ur(s){if(DirtyCheckSettings.disabled)return;if(++this.Br<DirtyCheckSettings.Vr)return;this.Br=0;const i=this.Nr,n=i.length;let h,e=0;for(;n>e;++e)(h=i[e]).Er()&&h.flush(t.LifecycleFlags.Vi)}}t.DirtyCheckProperty=class{constructor(t,s,i){this.G=s,this.J=i,this.zr=t}Er(){return this.oldValue!==this.G[this.J]}flush(s){const i=this.G[this.J];this.m(i,this.oldValue,s|t.LifecycleFlags.q),this.oldValue=i}subscribe(t){this.v()||(this.oldValue=this.G[this.J],this.zr.Fr(this)),this.l(t)}unsubscribe(t){this.u(t)&&!this.v()&&this.zr.removeProperty(this)}},t.DirtyCheckProperty=i([propertyObserver()],t.DirtyCheckProperty);const Vs=kernel.PLATFORM.Vn;class PrimitiveObserver{constructor(t,s){this.qr=1,"length"===s?(this.G=t,this.Y=this.Qr):this.Y=this.Hr}Qr(){return this.G.length}Hr(){}}PrimitiveObserver.prototype.Z=Vs,PrimitiveObserver.prototype.subscribe=Vs,PrimitiveObserver.prototype.unsubscribe=Vs,PrimitiveObserver.prototype.tt=Vs,PrimitiveObserver.prototype.M=Vs;class PropertyAccessor{constructor(t,s){this.G=t,this.J=s}Y(){return this.G[this.J]}Z(value){this.G[this.J]=value}M(s){(function(value,s,i){if(p(value)&&void 0!==value.F){const n=value.F[s];n&&void 0!==n.M&&n.M(i|t.LifecycleFlags.U|t.LifecycleFlags.q|t.LifecycleFlags.H)}})(this.G,this.J,s)}}const Ds={}.toString,IObserverLocator=kernel.DI.wn("IObserverLocator").eh(),ITargetObserverLocator=kernel.DI.wn("ITargetObserverLocator").eh(),ITargetAccessorLocator=kernel.DI.wn("ITargetAccessorLocator").eh();class Ls{constructor(t,s,i,n){this.Kr=[],this.zr=s,this.T=t,this.Wr=i,this._r=n}static register(t){return kernel.Registration.singleton(IObserverLocator,this).register(t)}rt(s,i,n){if(s&t.LifecycleFlags.xs&&"object"==typeof i)return t.ProxyObserver.Fs(i,n);if((function(t){return 1==t.un})(i))return i.bn(s).Fs(s,i,n);let h,e=i.F;return e&&n in e?e[n]:((h=this.Gr(s,i,n)).qr||(void 0===e&&(e=this.Jr(i)),e[n]=h),h)}Xr(t){this.Kr.push(t)}Be(s,i,n){return this._r.Yr(s,i)?this.Wr.Zr(s,i,n)?this.rt(s,i,n):this._r.Be(s,this.T,i,n):s&t.LifecycleFlags.xs?t.ProxyObserver.Fs(i,n):new PropertyAccessor(i,n)}Sr(t,s){return E(t,this.T,s)}Rr(t,s){return z(t,this.T,s)}$r(t,s){return q(t,this.T,s)}Jr(t){return t.F||this.so(t)}so(t){const value={};return Reflect.defineProperty(t,"$observers",{Bs:0,hn:0,br:0,value})||kernel.Reporter.write(0,t),value}io(t,s,i,n){for(let h=0,e=this.Kr.length;e>h;h++){const e=this.Kr[h].rt(t,s,i,n);if(e)return e}return null}Gr(s,i,n){if(!(i instanceof Object))return new PrimitiveObserver(i,n);let h=0;if(this.Wr.Yr(s,i)){const t=this.Wr.rt(s,this.T,this,i,n);if(null!==t)return t;if(null!==t)return t;h=1}switch(Ds.call(i)){case"[object Array]":return"length"===n?this.Sr(s,i).At(s):this.zr.xr(i,n);case"[object Map]":return"size"===n?this.Rr(s,i).At(s):this.zr.xr(i,n);case"[object Set]":return"size"===n?this.$r(s,i).At(s):this.zr.xr(i,n)}const e=(function(t,name){let s=Object.getOwnPropertyDescriptor(t,name),i=Object.getPrototypeOf(t);for(;void 0===s&&null!==i;)s=Object.getOwnPropertyDescriptor(i,name),i=Object.getPrototypeOf(i);return s})(i,n);if(e&&(e.get||e.set)){if(e.get&&e.get.rt)return e.get.rt(i);return this.io(s,i,n,e)||(h?this.zr.xr(i,n):(function(s,i,n,h,e,r,o){if(0==o.hn)return n.xr(e,r);if(o.get){const n=e.constructor.computed&&e.constructor.computed[r]||Is;return o.set?n.vr?new t.GetterObserver(s,n,e,r,o,i,h):new t.CustomSetterObserver(e,r,o):new t.GetterObserver(s,n,e,r,o,i,h)}throw kernel.Reporter.error(18,r)})(s,this,this.zr,this.T,i,n,e))}return new t.SetterObserver(s,i,n)}}Ls.inject=[ILifecycle,IDirtyChecker,ITargetObserverLocator,ITargetAccessorLocator];const Bs=kernel.PLATFORM.Vn;t.SelfObserver=class{constructor(s,i,n,h){this.X=s&t.LifecycleFlags.Ns,t.ProxyObserver.in(i)?(i.K.subscribe(this,n),this.G=i.sn,this.J=n,this._=i.sn[n],this.no=h in i.sn?i[h].bind(i):Bs):(this.G=i,this.J=n,this._=i[n],this.no=h in i?i[h].bind(i):Bs),s&t.LifecycleFlags.U&&(this.Y=this.en)}j(t,s,i){this.Z(t,i)}Y(){return this._}en(){return this.G[this.J]}Z(s,i){const n=this._;if((n!==s||i&t.LifecycleFlags.U)&&(this._=s,!(i&t.LifecycleFlags.ut))){const t=this.no(s,n,i);void 0!==t&&(this._=s=t),this.m(s,n,i)}}M(t){this.no(this.G[this.J],this._,this.X|t),this.m(this.G[this.J],this._,this.X|t)}},t.SelfObserver=i([propertyObserver()],t.SelfObserver);const{oneTime:Ns,Ws:xs,_s:Fs,Gs:Ms}=t.BindingMode;class BindingModeBehavior{constructor(mode){this.mode=mode}bind(t,s,i){i.ho=i.mode,i.mode=this.mode}Ne(t,s,i){i.mode=i.ho,i.ho=null}}class OneTimeBindingBehavior extends BindingModeBehavior{constructor(){super(Ns)}}BindingBehaviorResource.An("oneTime",OneTimeBindingBehavior);class ToViewBindingBehavior extends BindingModeBehavior{constructor(){super(xs)}}BindingBehaviorResource.An("toView",ToViewBindingBehavior);class FromViewBindingBehavior extends BindingModeBehavior{constructor(){super(Fs)}}BindingBehaviorResource.An("fromView",FromViewBindingBehavior);class TwoWayBindingBehavior extends BindingModeBehavior{constructor(){super(Ms)}}BindingBehaviorResource.An("twoWay",TwoWayBindingBehavior);const Us={},Es=t.BindingMode._s;class DebounceBindingBehavior{bind(s,i,n,h=200){let e,r,o;n instanceof t.Binding?(e="handleChange",o=H,r=n.mode&Es?t.LifecycleFlags.Ii:t.LifecycleFlags.q):(e="callSource",o=Q,r=t.LifecycleFlags.q),n.kt=n[e],n.kt.eo=e,n[e]=o,n.$t={Vt:r,Pt:h,It:0,oldValue:Us}}Ne(t,s,i){i[i.kt.eo]=i.kt,i.kt=null,kernel.PLATFORM.global.clearTimeout(i.$t.It),i.$t=null}}BindingBehaviorResource.An("debounce",DebounceBindingBehavior);class SignalBindingBehavior{constructor(t){this.ro=t}bind(t,s,i,...n){if(!i.De)throw kernel.Reporter.error(11);if(4===arguments.length){const name=n[0];this.ro.Cn(name,i),i.oo=name}else{if(4>=arguments.length)throw kernel.Reporter.error(12);{const t=[].slice.call(arguments,3);let s=t.length;for(;s--;)this.ro.Cn(t[s],i);i.oo=t}}}Ne(t,s,i){const name=i.oo;if(i.oo=null,Array.isArray(name)){const t=name;let s=t.length;for(;s--;)this.ro.On(t[s],i)}else this.ro.On(name,i)}}SignalBindingBehavior.inject=[ISignaler],BindingBehaviorResource.An("signal",SignalBindingBehavior);class ThrottleBindingBehavior{bind(s,i,n,h=200){let e;n.Bt=n[e=n instanceof t.Binding?n.mode===t.BindingMode.Gs?"updateSource":"updateTarget":"callSource"],n.Bt.eo=e,n[e]=K,n.Dt={Pt:h,Lt:0,It:-1}}Ne(t,s,i){i[i.Bt.eo]=i.Bt,i.Bt=null,kernel.PLATFORM.global.clearTimeout(i.Dt.It),i.Dt=null}}BindingBehaviorResource.An("throttle",ThrottleBindingBehavior);const zs={for(s){const i={add(i){let n;null!==i&&"object"==typeof i?n=i:"string"==typeof i&&(n={Nt:i});const h=n.Nt;if(!h)throw kernel.Reporter.error(0);return n.lo||(n.lo=kernel.PLATFORM.co(h)),n.no||(n.no=`${h}Changed`),void 0===n.mode&&(n.mode=t.BindingMode.Ws),s.bindables[h]=n,this},get:()=>s.bindables};if(void 0===s.bindables)s.bindables={};else if(Array.isArray(s.bindables)){const t=s.bindables;s.bindables={},t.forEach(i.add)}return i}},qs="custom-element",Qs="custom-attribute";(TargetedInstructionType=t.TargetedInstructionType||(t.TargetedInstructionType={})).uo="ra",TargetedInstructionType.ao="rb",TargetedInstructionType.fo="rc",TargetedInstructionType.do="rd",TargetedInstructionType.setProperty="re",TargetedInstructionType.ar="rf",TargetedInstructionType.bo="rg",TargetedInstructionType.po="rh",TargetedInstructionType.vo="ri",TargetedInstructionType.wo="rj",TargetedInstructionType.mo="rk";const ITargetedInstruction=kernel.DI.wn("createInterface").eh(),Hs=Object.freeze({required:1,compiler:"default"}),Ks=Object.freeze({required:0,compiler:"default"});class Ws{constructor(){this.name="unnamed",this.template=null,this.cache=0,this.build=Ks,this.bindables=kernel.PLATFORM.xt,this.instructions=kernel.PLATFORM.Gn,this.dependencies=kernel.PLATFORM.Gn,this.surrogates=kernel.PLATFORM.Gn,this.containerless=0,this.shadowOptions=null,this.hasSlots=0,this.strategy=1}}const _s=["name","template","cache","build","containerless","shadowOptions","hasSlots"],Gs=["instructions","dependencies","surrogates"],INode=(kernel.Profiler.yo("AttachLifecycle"),kernel.Profiler.yo("BindLifecycle"),kernel.DI.wn("INode").eh()),IRenderLocation=kernel.DI.wn("IRenderLocation").eh(),IDOM=kernel.DI.wn("IDOM").eh(),Js=function(){throw kernel.Reporter.error(1e3)},Xs={addEventListener:Js,appendChild:Js,cloneNode:Js,Co:Js,createDocumentFragment:Js,createElement:Js,Oo:Js,dispatchEvent:Js,jo:Js,Ao:Js,createTextNode:Js,insertBefore:Js,To:Js,So:Js,Ro:Js,$o:Js,ks:Js,remove:Js,removeEventListener:Js,setAttribute:Js},DOM=Object.assign({},Xs,{get Io(){return 1==Reflect.get(this,"$initialized")},initialize(dom){if(this.Io)throw kernel.Reporter.error(1001);const t={},s=[dom];let i=Object.getPrototypeOf(dom);for(;i&&i!==Object.prototype;)s.unshift(i),i=Object.getPrototypeOf(i);for(i of s)Object.assign(t,Object.getOwnPropertyDescriptors(i));const n=[];let h,e;for(h in t)(e=t[h]).hn&&e.br&&(Reflect.defineProperty(this,h,e),n.push(h));Reflect.set(this,"$domKeys",n),Reflect.set(this,"$initialized",1)},ko(){if(!this.Io)throw kernel.Reporter.error(1002);Reflect.get(this,"$domKeys").forEach(t=>{Reflect.deleteProperty(this,t)}),Object.assign(this,Xs),Reflect.set(this,"$domKeys",kernel.PLATFORM.Gn),Reflect.set(this,"$initialized",0)}}),NodeSequence={empty:{childNodes:kernel.PLATFORM.Gn,firstChild:null,lastChild:null,Po:()=>kernel.PLATFORM.Gn,insertBefore(t){},Vo(t){},remove(){}}};class Ys{constructor($lifecycle,cache){this.ms=null,this.Rs=null,this.qt=null,this.ss=null,this.qt=null,this.ss=null,this.Ht=null,this.hs=null,this.Do=null,this.Qh=null,this._h=null,this.Yh=null,this.$state=0,this.$scope=null,this.as=0,this.$lifecycle=$lifecycle,this.cache=cache}Lo(t){this.as=0,this.location=t}release(t){return this.as=1,8&this.$state?this.cache.Bo(this):!!this.Gh(t)}No(t){this.$scope=t,this.ys=ft,this.ds=vt}}class Zs{constructor(name,template,t){this.xo=0,this.Fo=-1,this.cache=null,this.T=t,this.name=name,this.template=template}Mo(t,s){t&&("*"===t?t=Zs.Uo:"string"==typeof t&&(t=parseInt(t,10)),-1!==this.Fo&&s||(this.Fo=t)),this.cache=this.Fo>0?[]:null,this.xo=this.Fo>0}Bo(t){return null!==this.cache&&this.Fo>this.cache.length}fs(s){return this.Bo(s)?(s.os(t.LifecycleFlags.ti),this.cache.push(s),1):0}create(t){const cache=this.cache;let s;if(null!==cache&&cache.length>0)return(s=cache.pop()).$state&=-129,s;if(s=new Ys(this.T,this),this.template.Vs(s,null,null,t),!s.$nodes)throw kernel.Reporter.error(90);return s}}Zs.Uo=65535,(t=>{t.ys=at,t.M=gt,t.ds=pt,t.Qt=Y,t.ns=st,t.os=ht,t.Hh=ot,t.Gh=lt})(Ys.prototype);const ITemplateCompiler=kernel.DI.wn("ITemplateCompiler").eh();(ViewCompileFlags=t.ViewCompileFlags||(t.ViewCompileFlags={}))[ViewCompileFlags.ti=1]="none",ViewCompileFlags[ViewCompileFlags.Eo=2]="surrogate",ViewCompileFlags[ViewCompileFlags.zo=4]="shadowDOM";const ITemplateFactory=kernel.DI.wn("ITemplateFactory").eh(),ti={qo:null,dom:null,Vs(t){t.$nodes=NodeSequence.empty,t.$context=null}},si="default",IInstructionRenderer=kernel.DI.wn("IInstructionRenderer").eh(),IRenderer=kernel.DI.wn("IRenderer").eh(),IRenderingEngine=kernel.DI.wn("IRenderingEngine").gn(t=>t.singleton(ii));class ii{constructor(t,s,i,n){this.Qo=new Map,this.Ho=t,this.Ko=s,this.Wo=new Map,this.T=i,this._o=new Map,this.Go=n.reduce((t,s)=>(t[s.name]=s,t),Object.create(null))}qs(dom,t,s,i){if(!t)return null;let n=this._o.get(t);return n||(n=this.Jo(dom,t,s,i),this._o.set(t,n)),n}Xo(dom,t,s){if(!t)return null;let i=this.Wo.get(t);if(!i){const n=buildTemplateDefinition(null,t),template=this.Jo(dom,n,s,null);(i=new Zs(n.name,template,this.T)).Mo(n.cache,1),this.Wo.set(t,i)}return i}Ms(t,s,i){let n=this.Qo.get(s);n||(n=ri.create(s),this.Qo.set(s,n)),n.Yo(t,i,this.T)}Jo(dom,s,i,n){if(null===i&&(i=this.Ho),null!==s.template){const h=createRenderContext(dom,i,s.dependencies,n);if(s.build.required){const i=s.build.compiler||si,compiler=this.Go[i];if(void 0===compiler)throw kernel.Reporter.error(20,i);s=compiler.compile(dom,s,new kernel.RuntimeCompilationResources(h),t.ViewCompileFlags.Eo)}return this.Ko.create(h,s)}return ti}}ii.inject=[kernel.IContainer,ITemplateFactory,ILifecycle,kernel.all(ITemplateCompiler)];class ni{constructor(){this.g=null}Ls(t){this.g=t}resolve(t,s){if(void 0===this.g)throw kernel.Reporter.error(50);return this.g}tt(){this.g=null}}class hi{Ls(t,parts){this.Zo=t,this.tl=parts||kernel.PLATFORM.xt}resolve(t,s){const i=this.Zo;if(null==i)throw kernel.Reporter.error(50);if(!i.name||!i.name.length)throw kernel.Reporter.error(51);const n=this.tl[i.name];if(n){const i=t.get(IRenderingEngine),dom=t.get(IDOM);return i.Xo(dom,n,s)}return i}tt(){this.Zo=null,this.tl=kernel.PLATFORM.xt}}let ei=class{constructor(t,customElement){this.Ot=0,this.children=null,this.customElement=customElement,this.T=t,this.W=0}Y(){return this.W||(this.W=1,this.customElement.cs.sl(()=>{this.il()}),this.children=wt(this.customElement.cs.children)),this.children}Z(t){}flush(s){this.m(this.children,void 0,s|t.LifecycleFlags.q),this.Ot=0}subscribe(t){this.l(t)}unsubscribe(t){this.u(t)}il(){this.children=wt(this.customElement.cs.children),"$childrenChanged"in this.customElement&&this.customElement.nl(),this.T.A(this).catch(t=>{throw t}),this.Ot=1}};ei=i([subscriberCollection(t.MutationKind.g)],ei);class ri{constructor(){}static create(t){const s=new ri;return s.bindables=t.description.bindables,s}Yo(t,s,i){s.$lifecycle=i,"$projector"in s?this.hl(t,i,s):this.el(t,s)}hl(t,s,i){this.el(t,i).rl=new ei(s,i),Reflect.defineProperty(i,"$children",{Bs:0,get(){return this.F.rl.Y()}})}el(s,i){const n={},bindables=this.bindables,h=Object.getOwnPropertyNames(bindables);if(s&t.LifecycleFlags.xs)for(let e=0,r=h.length;r>e;++e){const name=h[e];n[name]=new t.SelfObserver(s,t.ProxyObserver.Fs(i).O,name,bindables[name].no)}else{for(let e=0,r=h.length;r>e;++e){const name=h[e];n[name]=new t.SelfObserver(s,i,name,bindables[name].no),s&t.LifecycleFlags.U||mt(s,i,name)}Reflect.defineProperty(i,"$observers",{Bs:0,value:n})}return n}}const IProjectorLocator=kernel.DI.wn("IProjectorLocator").eh(),CustomElementResource={name:qs,st:W,jn(t){return t.kind===this},ol:_,An(t,s=null){if(!t)throw kernel.Reporter.error(70);const i=null===s?class{}:s,n=buildTemplateDefinition(i,t),h=i.prototype;return i.kind=CustomElementResource,i.description=n,i.register=yt,h.ll=jt,h.ys=ut,h.M=gt,h.Qt=X,h.ns=tt,h.ds=bt,h.os=nt,h.hs=null,h.Ht=null,h.Do=null,h.Yh=null,h.$scope=null,h.$hooks=0,h.ms=null,h.Rs=null,h.qt=null,h.ss=null,h.Hh=et,h.Gh=rt,h.Qh=null,h._h=null,h.cs=null,"flush"in h&&(h.pt=null),"binding"in h&&(h.$hooks|=4),"bound"in h&&(h.$hooks|=8,h.qh=null),"unbinding"in h&&(h.$hooks|=256),"unbound"in h&&(h.$hooks|=512,h.Zh=null),"render"in h&&(h.$hooks|=1024),"created"in h&&(h.$hooks|=2),"attaching"in h&&(h.$hooks|=16),"attached"in h&&(h.$hooks|=32,h.Kh=null),"detaching"in h&&(h.$hooks|=64),"caching"in h&&(h.$hooks|=2048),"detached"in h&&(h.$hooks|=128,h.Jh=null),i}},oi={mode:"open"},CustomAttributeResource=(kernel.Profiler.yo("RenderLifecycle"),{name:Qs,st:G,jn(t){return t.kind===this},An(i,n){const h=n,e=(function(def,i){const aliases=def.aliases,defaultBindingMode=def.defaultBindingMode;return{name:def.name,aliases:null==aliases?kernel.PLATFORM.Gn:aliases,defaultBindingMode:null==defaultBindingMode?t.BindingMode.Ws:defaultBindingMode,Hs:void 0===def.Hs?0:def.Hs,isTemplateController:void 0===def.isTemplateController?0:def.isTemplateController,bindables:Object.assign({},zs.for(i).get(),zs.for(def).get()),strategy:s(def.strategy)}})("string"==typeof i?{name:i}:i,h),r=h.prototype;return h.kind=CustomAttributeResource,h.description=e,h.register=At,r.ll=Ot,r.ys=ct,r.M=gt,r.Qt=J,r.ns=Z,r.ds=dt,r.os=it,r.hs=null,r.Ht=null,r.Do=null,r.Yh=null,r.$scope=null,r.$hooks=0,r.$state=0,"flush"in r&&(r.pt=null),"binding"in r&&(r.$hooks|=4),"bound"in r&&(r.$hooks|=8,r.qh=null),"unbinding"in r&&(r.$hooks|=256),"unbound"in r&&(r.$hooks|=512,r.Zh=null),"created"in r&&(r.$hooks|=2),"attaching"in r&&(r.$hooks|=16),"attached"in r&&(r.$hooks|=32,r.Kh=null),"detaching"in r&&(r.$hooks|=64),"caching"in r&&(r.$hooks|=2048),"detached"in r&&(r.$hooks|=128,r.Jh=null),h}});class If{constructor(s,i,n){this.value=0,this.Re=n,this.cl=null,this.ul=null,this.al=s,this.fl=null,this.location=i,this.X=t.LifecycleFlags.ti}vs(s){this.X=s&t.LifecycleFlags.Ns;const i=this.dl(s);this.Re.we(i,s),this.Re.vs(s,this.$scope)}Ut(t){this.Re.Ut(t)}Gt(t){this.Re.Gt(t)}Ts(t){this.Re.Ts(t)}es(t){null!==this.fl&&this.fl.release(t)&&(this.fl=null),null!==this.ul&&this.ul.release(t)&&(this.ul=null),this.Re.es(t)}bl(s,i,n){if(3&this.$state){n|=this.X;const s=t.ProxyObserver.Rt(this);if(n&t.LifecycleFlags.H){const t=s.dl(n);s.Re.we(t,n)}else s.$lifecycle.A(s).catch(t=>{throw t})}}flush(s){s|=this.X;const i=t.ProxyObserver.Rt(this),n=i.dl(s);i.Re.we(n,s)}dl(t){return this.value?this.fl=this.pl(this.fl,this.al,t):null!==this.cl?this.ul=this.pl(this.ul,this.cl,t):null}pl(t,s,i){return null===t&&(t=s.create(i)),t.Lo(this.location),t}}If.inject=[IViewFactory,IRenderLocation,CompositionCoordinator],i([bindable],If.prototype,"value",void 0),CustomAttributeResource.An({name:"if",isTemplateController:1},If);class Else{constructor(t){this.Zo=t}link(t){t.cl=this.Zo}}Else.inject=[IViewFactory],CustomAttributeResource.An({name:"else",isTemplateController:1},Else);class Repeat{constructor(t,s,i){this.Zo=i,this.vl=0,this.location=t,this.gl=null,this.wl=s,this.ml=[],this.key=null,this.Zs=0}vs(s){this.X=s&t.LifecycleFlags.Ns,this.yl(s);let i=this.wl.ms;for(;null!==i;){if(t.ProxyObserver.Rt(i.target)===t.ProxyObserver.Rt(this)&&"items"===i.Ve){this.Cl=i.Pe;break}i=i.Cs}this.Ol=this.Cl.jl.evaluate(s,this.$scope,null),this.Zs||(s&t.LifecycleFlags.Ai)>0?this.Al(null,s):this.Tl(null,s)}Ut(t){const{ml:s,location:i}=this;let n;for(let h=0,e=s.length;e>h;++h)(n=s[h]).Lo(i),n.Qt(t)}Gt(t){const{ml:s}=this;let i;for(let n=0,h=s.length;h>n;++n)(i=s[n]).ns(t),i.release(t)}Ts(t){this.yl(t);const{ml:s}=this;let i;for(let n=0,h=s.length;h>n;++n)(i=s[n]).ds(t)}Sl(s,i,n){n|=this.X;const h=t.ProxyObserver.Rt(this);h.yl(n),n|=t.LifecycleFlags.q,h.Zs||(n&t.LifecycleFlags.Ai)>0?h.Al(null,n):h.Tl(null,n)}N(s,i){i|=this.X;const n=t.ProxyObserver.Rt(this);i|=t.LifecycleFlags.H|t.LifecycleFlags.q,n.Zs||(i&t.LifecycleFlags.Ai)>0?n.Al(s,i):n.Tl(s,i)}Tl(t,s){const{ml:i,$lifecycle}=this;let n;if(3&this.$state){const{Ol:h,$scope,Zo:e,Cl:r,Rl:o}=this,l=i.length,c=r.count(s,o);if(c>l){i.length=c;for(let t=l;c>t;++t)i[t]=e.create(s)}else if(l>c){$lifecycle.Wt();for(let t=c;l>t;++t)(n=i[t]).release(s),n.ns(s);$lifecycle.Xt(s),$lifecycle.Os();for(let t=c;l>t;++t)(n=i[t]).ds(s);if($lifecycle.Ss(s),i.length=c,0===c)return}else if(0===c)return;$lifecycle.bs(),r.$l(s,o,null===t?(t,e,r)=>{(n=i[e]).ys(s,Scope.vn(s,$scope,n.$scope&&n.$scope.dn[h]===r?n.$scope.dn:BindingContext.create(s,h,r)))}:(e,r,o)=>{(n=i[r]).ys(s,Scope.vn(s,$scope,!n.$scope||t[r]!==r&&n.$scope.dn[h]!==o?BindingContext.create(s,h,o):n.$scope.dn))}),$lifecycle.gs(s)}if(12&this.$state){const{location:h}=this;if($lifecycle.Ft(),null===t)for(let t=0,e=i.length;e>t;++t)(n=i[t]).Lo(h),n.Qt(s);else for(let e=0,r=i.length;r>e;++e)t[e]!==e&&((n=i[e]).Lo(h),n.Qt(s));$lifecycle.zt(s)}}Al(s,i){const{$lifecycle,Ol:n,$scope,Zo:h,Cl:e,Rl:r}=this;let o=this.ml;if(null===s){if(3&this.$state){$lifecycle.Wt();const t=o.length;let s;for(let n=0;t>n;++n)(s=o[n]).release(i),s.ns(i);$lifecycle.Xt(i),$lifecycle.Os();for(let n=0;t>n;++n)(s=o[n]).ds(i);$lifecycle.Ss(i);const l=e.count(i,r);o=this.ml=Array(l),$lifecycle.bs(),e.$l(i,r,(t,e,r)=>{(s=o[e]=h.create(i)).ys(i,Scope.vn(i,$scope,BindingContext.create(i,n,r)))}),$lifecycle.gs(i)}if(12&this.$state){const{location:t}=this;let s;$lifecycle.Ft();const n=o.length;for(let h=0;n>h;++h)(s=o[h]).Lo(t),s.Qt(i);$lifecycle.zt(i)}}else{const e=s.length;let l;const c=s.yt,u=c.length;let a=0;if(3&this.$state){if(u>0){for($lifecycle.Wt(),a=0;u>a;++a)(l=o[c[a]]).release(i),l.ns(i);for($lifecycle.Xt(i),$lifecycle.Os(),a=0;u>a;++a)(l=o[c[a]]).ds(i);$lifecycle.Ss(i),a=0;let t=0,n=0;for(c.sort();u>a;++a)for(o.splice(t=c[a]-a,1),n=0;e>n;++n)t>s[n]||--s[n]}for($lifecycle.bs(),a=0;e>a;++a)-2===s[a]&&((l=h.create(i)).ys(i,Scope.vn(i,$scope,BindingContext.create(i,n,r[a]))),o.splice(a,0,l));if($lifecycle.gs(i),o.length!==e)throw Error(`viewsLen=${o.length}, mapLen=${e}`)}if(12&this.$state){const{location:n}=this,h=(function(t){const s=t.length,i=s+t.yt.length,n=255>i?Uint8Array:65535>i?Uint16Array:Uint32Array;s>ui&&(ui=s,li=new n(s),ci=new n(s));let h=0,e=0,r=0,o=0,l=0,c=0,u=0,a=0;for(;s>o;o++)if(-2!==(e=t[o])){if(-2!==(r=t[l=li[h]])&&e>r){ci[o]=l,li[++h]=o;continue}for(c=0,u=h;u>c;)-2!==(r=t[li[a=c+u>>1]])&&e>r?c=a+1:u=a;((r=t[li[c]])>e||-2===r)&&(c>0&&(li[o]=li[c-1]),li[c]=o)}const f=new n(o=++h);for(e=li[h-1];h-- >0;)f[h]=e,e=ci[e];for(;o-- >0;)li[o]=0;return f})(s),e=h.length;$lifecycle.Wt(),$lifecycle.Ft(),$lifecycle.Kt({Hh(){let r=n,c=e-1;for(a=s.length-1;a>=0;--a)if(-2===s[a]){(l=o[a]).$state|=4;let s=l.qt;for(;null!==s;)s.Qt(i|t.LifecycleFlags.Mt),s=s.Ht;l.$nodes.insertBefore(r),l.$state|=24,l.$state&=-5,r=l.$nodes.firstChild}else if(0>c||1===e||a!==h[c]){(l=o[s[a]]).$state|=32;let n=l.ss;for(;null!==n;)n.ns(i|t.LifecycleFlags._t),n=n.hs;for(l.$nodes.remove(),l.$state&=-57,l.$state|=4,n=l.qt;null!==n;)n.Qt(i|t.LifecycleFlags.Mt),n=n.Ht;l.$nodes.insertBefore(r),l.$state|=24,l.$state&=-5,r=l.$nodes.firstChild}else r=(l=o[a]).$nodes.firstChild,--c},Qh:null}),$lifecycle.Xt(i),$lifecycle.zt(i)}}}yl(s){const i=t.ProxyObserver.Rt(this),n=i.gl;if(3&i.$state){const t=i.gl=getCollectionObserver(s,i.$lifecycle,i.Rl);n!==t&&n&&n.St(i),t&&t.Tt(i)}else n&&n.St(i)}}let li,ci;Repeat.inject=[IRenderLocation,IRenderable,IViewFactory],i([bindable],Repeat.prototype,"items",void 0),CustomAttributeResource.An({name:"repeat",isTemplateController:1},Repeat);let ui=0;class Replaceable{constructor(t,s){this.Zo=t,this.currentView=this.Zo.create(),this.currentView.Lo(s)}vs(s){this.currentView.ys(s|t.LifecycleFlags.Ui,this.$scope)}Ut(t){this.currentView.Qt(t)}Gt(t){this.currentView.ns(t)}Ts(t){this.currentView.ds(t)}}Replaceable.inject=[IViewFactory,IRenderLocation],CustomAttributeResource.An({name:"replaceable",isTemplateController:1},Replaceable);class With{constructor(t,s){this.value=null,this.Zo=t,this.currentView=this.Zo.create(),this.currentView.Lo(s)}bl(){3&this.$state&&this.Il(t.LifecycleFlags.Ni)}vs(t){this.Il(t)}Ut(t){this.currentView.Qt(t)}Gt(t){this.currentView.ns(t)}Ts(t){this.currentView.ds(t)}Il(t){const s=Scope.vn(t,this.$scope,this.value);this.currentView.ys(t,s)}}With.inject=[IViewFactory,IRenderLocation],i([bindable],With.prototype,"value",void 0),CustomAttributeResource.An({name:"with",isTemplateController:1},With);const ISanitizer=kernel.DI.wn("ISanitizer").gn(t=>t.singleton(class{kl(t){return t.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"")}}));class SanitizeValueConverter{constructor(t){this.Pl=t}Ws(t){return null==t?null:this.Pl.kl(t)}}SanitizeValueConverter.inject=[ISanitizer],ValueConverterResource.An("sanitize",SanitizeValueConverter),kernel.Profiler.yo("Aurelia.start"),kernel.Profiler.yo("Aurelia.stop");class Aurelia{constructor(t=kernel.DI.Vl()){this.Ho=t,this.Dl=[],this.Ll=[],this.Bl=[],this.Nl=0,this.xl=null,kernel.Registration.g(Aurelia,this).register(t,Aurelia)}register(...t){return this.Ho.register(...t),this}app(s){const host=s.host;this.Ho.get(IDOMInitializer).initialize(s);const i=t.LifecycleFlags.Di|s.strategy,n=t.LifecycleFlags.Zt|s.strategy;let component;const h=s.component;CustomElementResource.jn(h)?(this.Ho.register(h),component=this.Ho.get(CustomElementResource.st(h.description.name))):component=h,component=t.ProxyObserver.Rt(component);const e=()=>{host.$au=this,this.Dl.includes(component)||(this.xl=component,this.Dl.push(component),component.ll(i,this.Ho,host)),component.ys(i|t.LifecycleFlags.ut,null),component.Qt(i|t.LifecycleFlags.Mt)};return this.Ll.push(e),this.Bl.push(()=>{component.ns(n|t.LifecycleFlags._t),component.ds(n|t.LifecycleFlags.js),host.$au=null}),this.Nl&&e(),this}root(){return t.ProxyObserver.tn(this.xl)}start(){for(const t of this.Ll)t();return this.Nl=1,this}stop(){this.Nl=0;for(const t of this.Bl)t();return this}}kernel.PLATFORM.global.Aurelia=Aurelia;const IDOMInitializer=kernel.DI.wn("IDOMInitializer").eh();class ai{constructor(t){const s=this.Fl={};t.forEach(t=>{s[t.Ks]=t})}static register(t){return kernel.Registration.singleton(IRenderer,this).register(t)}Vs(t,dom,s,i,targets,n,host,parts){const h=n.instructions,e=this.Fl;if(targets.length!==h.length)throw kernel.Reporter.error(targets.length>h.length?30:31);let instructions,r,o;for(let n=0,l=targets.length;l>n;++n){r=targets[n];for(let l=0,c=(instructions=h[n]).length;c>l;++l)e[(o=instructions[l]).type].Vs(t,dom,s,i,r,o,parts)}if(host){const h=n.surrogates;for(let n=0,r=h.length;r>n;++n)e[(o=h[n]).type].Vs(t,dom,s,i,host,o,parts)}}}ai.inject=[kernel.all(IInstructionRenderer)];let fi=class{Vs(t,dom,s,i,n,h){n[h.to]=h.value}};fi=i([instructionRenderer("re")],fi);let di=class{Vs(t,dom,s,i,n,h){const e=s.Ds(i,n,h,null,null,n,1),component=s.get(W(h.res)),r=s.get(IRenderer).Fl,o=h.instructions;let l;component.ll(t,s,n,h);for(let n=0,h=o.length;h>n;++n)r[(l=o[n]).type].Vs(t,dom,s,i,component,l);addComponent(i,component),e.tt()}};di=i([instructionRenderer("ra")],di);let bi=class{Vs(t,dom,s,i,n,h){const e=s.Ds(i,n,h),component=s.get(G(h.res)),r=s.get(IRenderer).Fl,o=h.instructions;let l;component.ll(t,s);for(let n=0,h=o.length;h>n;++n)r[(l=o[n]).type].Vs(t,dom,s,i,component,l);addComponent(i,component),e.tt()}};bi=i([instructionRenderer("rb")],bi);let pi=class{constructor(t){this.Ml=t}Vs(t,dom,s,i,n,h,parts){const e=this.Ml.Xo(dom,h.def,s),r=s.Ds(i,n,h,e,parts,dom.Co(n),0),component=s.get(G(h.res)),o=s.get(IRenderer).Fl,l=h.instructions;let c;component.ll(t,s),h.link&&component.link(i.ss);for(let n=0,h=l.length;h>n;++n)o[(c=l[n]).type].Vs(t,dom,s,i,component,c);addComponent(i,component),r.tt()}};pi.inject=[IRenderingEngine],pi=i([instructionRenderer("rc")],pi);let vi=class{constructor(t,s){this.Ul=t,this.ot=s}Vs(s,dom,i,n,h,e){dom.remove(h);const r=e.instructions,toViewModel=e.toViewModel;let o,l,c;for(let s=0,h=r.length;h>s;++s)l=ensureExpression(this.Ul,(o=r[s]).from,48),addBinding(n,c=new t.LetBinding(l,o.to,this.ot,i,toViewModel))}};vi.inject=[IExpressionParser,IObserverLocator],vi=i([instructionRenderer("rd")],vi);let gi=class{constructor(t,s){this.Ul=t,this.ot=s}Vs(t,dom,s,i,n,h){const e=ensureExpression(this.Ul,h.from,153);addBinding(i,new Call(e,n,h.to,this.ot,s))}};gi.inject=[IExpressionParser,IObserverLocator],gi=i([instructionRenderer("rh")],gi);let wi=class{constructor(t){this.Ul=t}Vs(t,dom,s,i,n,h){const e=ensureExpression(this.Ul,h.from,1280);addBinding(i,new Ref(e,n,s))}};wi.inject=[IExpressionParser],wi=i([instructionRenderer("rj")],wi);let mi=class{constructor(t,s){this.Ul=t,this.ot=s}Vs(s,dom,i,n,h,e){let r;const o=ensureExpression(this.Ul,e.from,2048);addBinding(n,r=o.El?new MultiInterpolationBinding(this.ot,o,h,e.to,t.BindingMode.Ws,i):new t.InterpolationBinding(o.zl,o,h,e.to,t.BindingMode.Ws,this.ot,i,1))}};mi.inject=[IExpressionParser,IObserverLocator],mi=i([instructionRenderer("rf")],mi);let yi=class{constructor(t,s){this.Ul=t,this.ot=s}Vs(s,dom,i,n,h,e){const r=ensureExpression(this.Ul,e.from,48|e.mode);addBinding(n,new t.Binding(r,h,e.to,e.mode,this.ot,i))}};yi.inject=[IExpressionParser,IObserverLocator],yi=i([instructionRenderer("rg")],yi);let Ci=class{constructor(t,s){this.Ul=t,this.ot=s}Vs(s,dom,i,n,h,e){const r=ensureExpression(this.Ul,e.from,539);addBinding(n,new t.Binding(r,h,e.to,t.BindingMode.Ws,this.ot,i))}};Ci.inject=[IExpressionParser,IObserverLocator],Ci=i([instructionRenderer("rk")],Ci);class Oi{bind(t,s,i,n){i.target.key=n,i.target.Zs=1}Ne(t,s,i){i.target.key=null,i.target.Zs=0}}BindingBehaviorResource.An("keyed",Oi);const IObserverLocatorRegistration=Ls,ILifecycleRegistration=zt,IRendererRegistration=ai,DefaultComponents=[IObserverLocatorRegistration,ILifecycleRegistration,IRendererRegistration],IfRegistration=If,ElseRegistration=Else,RepeatRegistration=Repeat,ReplaceableRegistration=Replaceable,WithRegistration=With,SanitizeValueConverterRegistration=SanitizeValueConverter,DebounceBindingBehaviorRegistration=DebounceBindingBehavior,KeyedBindingBehaviorRegistration=Oi,OneTimeBindingBehaviorRegistration=OneTimeBindingBehavior,ToViewBindingBehaviorRegistration=ToViewBindingBehavior,FromViewBindingBehaviorRegistration=FromViewBindingBehavior,SignalBindingBehaviorRegistration=SignalBindingBehavior,ThrottleBindingBehaviorRegistration=ThrottleBindingBehavior,TwoWayBindingBehaviorRegistration=TwoWayBindingBehavior,DefaultResources=[IfRegistration,ElseRegistration,RepeatRegistration,ReplaceableRegistration,WithRegistration,SanitizeValueConverterRegistration,DebounceBindingBehaviorRegistration,KeyedBindingBehaviorRegistration,OneTimeBindingBehaviorRegistration,ToViewBindingBehaviorRegistration,FromViewBindingBehaviorRegistration,SignalBindingBehaviorRegistration,ThrottleBindingBehaviorRegistration,TwoWayBindingBehaviorRegistration],CallBindingRendererRegistration=gi,CustomAttributeRendererRegistration=bi,CustomElementRendererRegistration=di,InterpolationBindingRendererRegistration=mi,IteratorBindingRendererRegistration=Ci,LetElementRendererRegistration=vi,PropertyBindingRendererRegistration=yi,RefBindingRendererRegistration=wi,SetPropertyRendererRegistration=fi,TemplateControllerRendererRegistration=pi,DefaultRenderers=[PropertyBindingRendererRegistration,IteratorBindingRendererRegistration,CallBindingRendererRegistration,RefBindingRendererRegistration,InterpolationBindingRendererRegistration,SetPropertyRendererRegistration,CustomElementRendererRegistration,CustomAttributeRendererRegistration,TemplateControllerRendererRegistration,LetElementRendererRegistration],RuntimeBasicConfiguration={register:t=>t.register(...DefaultComponents,...DefaultResources,...DefaultRenderers),Vl(){return this.register(kernel.DI.Vl())}};t.CallFunction=class{constructor(t,s){this.it=1162,this.assign=kernel.PLATFORM.Vn,this.ql=t,this.Mn=s}evaluate(s,i,n){const h=this.ql.evaluate(s,i,n);if("function"==typeof h)return h.apply(null,C(s,i,n,this.Mn));if(s&t.LifecycleFlags.ht||null!=h)throw kernel.Reporter.error(207,this)}connect(t,s,i){const n=this.ql.evaluate(t,s,null);if(this.ql.connect(t,s,i),"function"==typeof n){const n=this.Mn;for(let h=0,e=n.length;e>h;++h)n[h].connect(t,s,i)}}accept(t){return t.Ql(this)}},t.connects=function(t){return 32==(32&t.it)},t.observes=function(t){return 64==(64&t.it)},t.callsFunction=function(t){return 128==(128&t.it)},t.hasAncestor=function(t){return 256==(256&t.it)},t.isAssignable=function(t){return 8192==(8192&t.it)},t.isLeftHandSide=function(t){return 1024==(1024&t.it)},t.isPrimary=function(t){return 512==(512&t.it)},t.isResource=function(t){return 32768==(32768&t.it)},t.hasBind=hasBind,t.hasUnbind=hasUnbind,t.isLiteral=isLiteral,t.arePureLiterals=arePureLiterals,t.isPureLiteral=isPureLiteral,t.BindingBehavior=class{constructor(t,name,s){this.it=38962,this.Hl=t,this.name=name,this.Mn=s,this.Kl=BindingBehaviorResource.st(this.name)}evaluate(t,s,i){return this.Hl.evaluate(t,s,i)}assign(t,s,i,value){return this.Hl.assign(t,s,i,value)}connect(t,s,i){this.Hl.connect(t,s,i)}bind(t,s,i){if(void 0===s)throw kernel.Reporter.error(250,this);if(null===s)throw kernel.Reporter.error(251,this);if(!i)throw kernel.Reporter.error(206,this);const n=i.ke;if(!n)throw kernel.Reporter.error(202,this);hasBind(this.Hl)&&this.Hl.bind(t,s,i);const h=this.Kl,e=n.get(h);if(!e)throw kernel.Reporter.error(203,this);null==i[h]?(i[h]=e,e.bind.apply(e,[t,s,i].concat(C(t,s,n,this.Mn)))):kernel.Reporter.write(204,this)}Ne(t,s,i){const n=this.Kl;null!=i[n]?(i[n].Ne(t,s,i),i[n]=null):kernel.Reporter.write(204,this),hasUnbind(this.Hl)&&this.Hl.Ne(t,s,i)}accept(t){return t.Wl(this)}},t.ValueConverter=class{constructor(t,name,s){this.it=36913,this.Hl=t,this.name=name,this.Mn=s,this._l=ValueConverterResource.st(this.name)}evaluate(t,s,i){if(!i)throw kernel.Reporter.error(202,this);const n=i.get(this._l);if(!n)throw kernel.Reporter.error(205,this);if("toView"in n){const h=this.Mn,e=h.length,r=Array(e+1);r[0]=this.Hl.evaluate(t,s,i);for(let n=0;e>n;++n)r[n+1]=h[n].evaluate(t,s,i);return n.Ws.apply(n,r)}return this.Hl.evaluate(t,s,i)}assign(t,s,i,value){if(!i)throw kernel.Reporter.error(202,this);const n=i.get(this._l);if(!n)throw kernel.Reporter.error(205,this);return"fromView"in n&&(value=n._s.apply(n,[value].concat(C(t,s,i,this.Mn)))),this.Hl.assign(t,s,i,value)}connect(t,s,i){if(void 0===s)throw kernel.Reporter.error(250,this);if(null===s)throw kernel.Reporter.error(251,this);if(!i)throw kernel.Reporter.error(206,this);const n=i.ke;if(!n)throw kernel.Reporter.error(202,this);this.Hl.connect(t,s,i);const h=this.Mn;for(let n=0,e=h.length;e>n;++n)h[n].connect(t,s,i);const e=n.get(this._l);if(!e)throw kernel.Reporter.error(205,this);const r=e.mn;if(void 0===r)return;const o=n.get(ISignaler);for(let t=0,s=r.length;s>t;++t)o.Cn(r[t],i)}Ne(t,s,i){const n=i.ke,h=n.get(this._l).mn;if(void 0===h)return;const e=n.get(ISignaler);for(let t=0,s=h.length;s>t;++t)e.On(h[t],i)}accept(t){return t.Gl(this)}},t.Assign=class{constructor(t,value){this.it=8208,this.target=t,this.value=value}evaluate(t,s,i){return this.target.assign(t,s,i,this.value.evaluate(t,s,i))}connect(t,s,i){}assign(t,s,i,value){return this.value.assign(t,s,i,value),this.target.assign(t,s,i,value)}accept(t){return t.Jl(this)}},t.Conditional=class{constructor(t,s,i){this.it=63,this.assign=kernel.PLATFORM.Vn,this.Xl=t,this.Yl=s,this.Zl=i}evaluate(t,s,i){return this.Xl.evaluate(t,s,i)?this.Yl.evaluate(t,s,i):this.Zl.evaluate(t,s,i)}connect(t,s,i){this.Xl.evaluate(t,s,null)?(this.Xl.connect(t,s,i),this.Yl.connect(t,s,i)):(this.Xl.connect(t,s,i),this.Zl.connect(t,s,i))}accept(t){return t.tc(this)}},t.AccessThis=AccessThis,t.AccessScope=AccessScope,t.AccessMember=AccessMember,t.AccessKeyed=class{constructor(t,s){this.it=9324,this.object=t,this.key=s}evaluate(t,s,i){const n=this.object.evaluate(t,s,i);if(null!=n)return n[this.key.evaluate(t,s,i)]}assign(t,s,i,value){return this.object.evaluate(t,s,i)[this.key.evaluate(t,s,i)]=value}connect(s,i,n){const h=this.object.evaluate(s,i,null);if(this.object.connect(s,i,n),"object"==typeof h&&null!==h){this.key.connect(s,i,n);const e=this.key.evaluate(s,i,null);Array.isArray(h)&&(function(value){const t=typeof value;if("number"===t)return 1;if("string"!==t)return 0;const s=value.length;if(0===s)return 0;let i;for(let t=0;s>t;++t)if(48>(i=value.charCodeAt(t))||i>57)return 0;return 1})(e)?s&t.LifecycleFlags.xs&&n.ct(s,h,e):n.ct(s,h,e)}}accept(t){return t.sc(this)}},t.CallScope=CallScope,t.CallMember=CallMember,t.Binary=class{constructor(t,s,i){this.it=46,this.assign=kernel.PLATFORM.Vn,this.ic=t,this.left=s,this.right=i,this.evaluate=this[t]}evaluate(t,s,i){throw kernel.Reporter.error(208,this)}connect(t,s,i){const n=this.left.evaluate(t,s,null);this.left.connect(t,s,i),"&&"===this.ic&&!n||"||"===this.ic&&n||this.right.connect(t,s,i)}nc(t,s,i){return this.left.evaluate(t,s,i)&&this.right.evaluate(t,s,i)}hc(t,s,i){return this.left.evaluate(t,s,i)||this.right.evaluate(t,s,i)}ec(t,s,i){return this.left.evaluate(t,s,i)==this.right.evaluate(t,s,i)}rc(t,s,i){return this.left.evaluate(t,s,i)===this.right.evaluate(t,s,i)}oc(t,s,i){return this.left.evaluate(t,s,i)!=this.right.evaluate(t,s,i)}lc(t,s,i){return this.left.evaluate(t,s,i)!==this.right.evaluate(t,s,i)}cc(t,s,i){const n=this.right.evaluate(t,s,i);return"function"==typeof n?this.left.evaluate(t,s,i)instanceof n:0}uc(t,s,i){const n=this.right.evaluate(t,s,i);return null!==n&&"object"==typeof n?this.left.evaluate(t,s,i)in n:0}ac(t,s,i){return this.left.evaluate(t,s,i)+this.right.evaluate(t,s,i)}fc(t,s,i){return this.left.evaluate(t,s,i)-this.right.evaluate(t,s,i)}dc(t,s,i){return this.left.evaluate(t,s,i)*this.right.evaluate(t,s,i)}bc(t,s,i){return this.left.evaluate(t,s,i)/this.right.evaluate(t,s,i)}pc(t,s,i){return this.left.evaluate(t,s,i)%this.right.evaluate(t,s,i)}vc(t,s,i){return this.left.evaluate(t,s,i)<this.right.evaluate(t,s,i)}gc(t,s,i){return this.left.evaluate(t,s,i)>this.right.evaluate(t,s,i)}wc(t,s,i){return this.left.evaluate(t,s,i)<=this.right.evaluate(t,s,i)}mc(t,s,i){return this.left.evaluate(t,s,i)>=this.right.evaluate(t,s,i)}accept(t){return t.yc(this)}},t.Unary=class{constructor(t,s){this.it=39,this.assign=kernel.PLATFORM.Vn,this.ic=t,this.Hl=s,this.evaluate=this[t]}evaluate(t,s,i){throw kernel.Reporter.error(208,this)}connect(t,s,i){this.Hl.connect(t,s,i)}Cc(t,s,i){this.Hl.evaluate(t,s,i)}Oc(t,s,i){return typeof this.Hl.evaluate(t,s,i)}jc(t,s,i){return!this.Hl.evaluate(t,s,i)}fc(t,s,i){return-this.Hl.evaluate(t,s,i)}ac(t,s,i){return+this.Hl.evaluate(t,s,i)}accept(t){return t.Ac(this)}},t.PrimitiveLiteral=PrimitiveLiteral,t.HtmlLiteral=class{constructor(parts){this.it=51,this.assign=kernel.PLATFORM.Vn,this.parts=parts}evaluate(t,s,i){const n=this.parts;let value,h="";for(let e=0,r=n.length;r>e;++e)null!=(value=n[e].evaluate(t,s,i))&&(h+=value);return h}connect(t,s,i){for(let n=0,h=this.parts.length;h>n;++n)this.parts[n].connect(t,s,i)}accept(t){return t.Tc(this)}},t.ArrayLiteral=ArrayLiteral,t.ObjectLiteral=ObjectLiteral,t.Template=Template,t.TaggedTemplate=class{constructor(t,s,i,n){this.it=1197,this.assign=kernel.PLATFORM.Vn,this.Xn=t,this.Xn.raw=s,this.ql=i,this.nt=void 0===n?kernel.PLATFORM.Gn:n}evaluate(t,s,i){const n=this.nt,h=n.length,e=Array(h);for(let r=0,o=h;o>r;++r)e[r]=n[r].evaluate(t,s,i);const r=this.ql.evaluate(t,s,i);if("function"!=typeof r)throw kernel.Reporter.error(207,this);return r.apply(null,[this.Xn].concat(e))}connect(t,s,i){const n=this.nt;for(let h=0,e=n.length;e>h;++h)n[h].connect(t,s,i);this.ql.connect(t,s,i)}accept(t){return t.Sc(this)}},t.ArrayBindingPattern=class{constructor(t){this.it=65556,this.elements=t}evaluate(t,s,i){}assign(t,s,i,n){}connect(t,s,i){}accept(t){return t.Rc(this)}},t.ObjectBindingPattern=class{constructor(t,s){this.it=65557,this.keys=t,this.values=s}evaluate(t,s,i){}assign(t,s,i,n){}connect(t,s,i){}accept(t){return t.$c(this)}},t.BindingIdentifier=class{constructor(name){this.it=65558,this.name=name}evaluate(t,s,i){return this.name}connect(t,s,i){}accept(t){return t.Ic(this)}},t.ForOfStatement=class{constructor(t,s){this.it=6199,this.assign=kernel.PLATFORM.Vn,this.jl=t,this.kc=s}evaluate(t,s,i){return this.kc.evaluate(t,s,i)}count(t,s){return Ut[xt.call(s)](s)}$l(s,i,n){Mt[xt.call(i)](s|t.LifecycleFlags.Mi,i,n)}connect(t,s,i){this.jl.connect(t,s,i),this.kc.connect(t,s,i)}bind(t,s,i){hasBind(this.kc)&&this.kc.bind(t,s,i)}Ne(t,s,i){hasUnbind(this.kc)&&this.kc.Ne(t,s,i)}accept(t){return t.Pc(this)}},t.Interpolation=class{constructor(parts,t){this.it=24,this.assign=kernel.PLATFORM.Vn,this.parts=parts,this.nt=void 0===t?kernel.PLATFORM.Gn:t,this.El=this.nt.length>1,this.zl=this.nt[0]}evaluate(t,s,i){if(this.El){const n=this.nt,parts=this.parts;let h=parts[0];for(let e=0,r=n.length;r>e;++e)h+=n[e].evaluate(t,s,i),h+=parts[e+1];return h}{const parts=this.parts;return parts[0]+this.zl.evaluate(t,s,i)+parts[1]}}connect(t,s,i){}accept(t){return t.Vc(this)}},t.Call=Call,t.connectable=connectable,t.IExpressionParser=IExpressionParser,t.MultiInterpolationBinding=MultiInterpolationBinding,t.Ref=Ref,t.enableArrayObservation=enableArrayObservation,t.disableArrayObservation=function(){for(const t of ls)1==Zt[t].W&&def(Zt,t,Object.assign({},us,{value:os[t]}))},t.enableMapObservation=enableMapObservation,t.disableMapObservation=function(){for(const t of vs)1==as[t].W&&ms(as,t,Object.assign({},ws,{value:ps[t]}))},t.enableSetObservation=enableSetObservation,t.disableSetObservation=function(){for(const t of Ts)1==ys[t].W&&$s(ys,t,Object.assign({},Rs,{value:As[t]}))},t.BindingContext=BindingContext,t.Scope=Scope,t.OverrideContext=OverrideContext,t.collectionObserver=collectionObserver,t.computed=function(t){return function(s,i){(s.computed||(s.computed={}))[i]=t}},t.IDirtyChecker=IDirtyChecker,t.DirtyCheckSettings=DirtyCheckSettings,t.IObserverLocator=IObserverLocator,t.ITargetObserverLocator=ITargetObserverLocator,t.ITargetAccessorLocator=ITargetAccessorLocator,t.getCollectionObserver=getCollectionObserver,t.PrimitiveObserver=PrimitiveObserver,t.PropertyAccessor=PropertyAccessor,t.propertyObserver=propertyObserver,t.ISignaler=ISignaler,t.subscriberCollection=subscriberCollection,t.batchedSubscriberCollection=batchedSubscriberCollection,t.targetObserver=targetObserver,t.bindingBehavior=function(t){return s=>BindingBehaviorResource.An(t,s)},t.BindingBehaviorResource=BindingBehaviorResource,t.BindingModeBehavior=BindingModeBehavior,t.OneTimeBindingBehavior=OneTimeBindingBehavior,t.ToViewBindingBehavior=ToViewBindingBehavior,t.FromViewBindingBehavior=FromViewBindingBehavior,t.TwoWayBindingBehavior=TwoWayBindingBehavior,t.DebounceBindingBehavior=DebounceBindingBehavior,t.SignalBindingBehavior=SignalBindingBehavior,t.ThrottleBindingBehavior=ThrottleBindingBehavior,t.customAttribute=function(t){return s=>CustomAttributeResource.An(t,s)},t.CustomAttributeResource=CustomAttributeResource,t.dynamicOptions=function(t){return void 0===t?Tt:Tt(t)},t.templateController=function(t){return s=>CustomAttributeResource.An("string"==typeof t?{isTemplateController:1,name:t}:Object.assign({isTemplateController:1},t),s)},t.If=If,t.Else=Else,t.Repeat=Repeat,t.Replaceable=Replaceable,t.With=With,t.containerless=function(t){return void 0===t?Ct:Ct(t)},t.customElement=function(t){return s=>CustomElementResource.An(t,s)},t.CustomElementResource=CustomElementResource,t.IProjectorLocator=IProjectorLocator,t.useShadowDOM=function(t){function s(t){return t.shadowOptions=i,t}const i="function"!=typeof t&&t?t:oi;return"function"==typeof t?s(t):s},t.valueConverter=function(t){return s=>ValueConverterResource.An(t,s)},t.ValueConverterResource=ValueConverterResource,t.ISanitizer=ISanitizer,t.SanitizeValueConverter=SanitizeValueConverter,t.bindable=bindable,t.Aurelia=Aurelia,t.IDOMInitializer=IDOMInitializer,t.IfRegistration=IfRegistration,t.ElseRegistration=ElseRegistration,t.RepeatRegistration=RepeatRegistration,t.ReplaceableRegistration=ReplaceableRegistration,t.WithRegistration=WithRegistration,t.SanitizeValueConverterRegistration=SanitizeValueConverterRegistration,t.DebounceBindingBehaviorRegistration=DebounceBindingBehaviorRegistration,t.OneTimeBindingBehaviorRegistration=OneTimeBindingBehaviorRegistration,t.ToViewBindingBehaviorRegistration=ToViewBindingBehaviorRegistration,t.FromViewBindingBehaviorRegistration=FromViewBindingBehaviorRegistration,t.SignalBindingBehaviorRegistration=SignalBindingBehaviorRegistration,t.ThrottleBindingBehaviorRegistration=ThrottleBindingBehaviorRegistration,t.TwoWayBindingBehaviorRegistration=TwoWayBindingBehaviorRegistration,t.KeyedBindingBehaviorRegistration=KeyedBindingBehaviorRegistration,t.RefBindingRendererRegistration=RefBindingRendererRegistration,t.CallBindingRendererRegistration=CallBindingRendererRegistration,t.CustomAttributeRendererRegistration=CustomAttributeRendererRegistration,t.CustomElementRendererRegistration=CustomElementRendererRegistration,t.InterpolationBindingRendererRegistration=InterpolationBindingRendererRegistration,t.IteratorBindingRendererRegistration=IteratorBindingRendererRegistration,t.LetElementRendererRegistration=LetElementRendererRegistration,t.PropertyBindingRendererRegistration=PropertyBindingRendererRegistration,t.SetPropertyRendererRegistration=SetPropertyRendererRegistration,t.TemplateControllerRendererRegistration=TemplateControllerRendererRegistration,t.DefaultResources=DefaultResources,t.IObserverLocatorRegistration=IObserverLocatorRegistration,t.ILifecycleRegistration=ILifecycleRegistration,t.IRendererRegistration=IRendererRegistration,t.RuntimeBasicConfiguration=RuntimeBasicConfiguration,t.buildTemplateDefinition=buildTemplateDefinition,t.isTargetedInstruction=function(value){const type=value.type;return"string"==typeof type&&2===type.length},t.ITargetedInstruction=ITargetedInstruction,t.DOM=DOM,t.INode=INode,t.IRenderLocation=IRenderLocation,t.IDOM=IDOM,t.NodeSequence=NodeSequence,t.CallBindingInstruction=class{constructor(from,to){this.type="rh",this.from=from,this.to=to}},t.FromViewBindingInstruction=class{constructor(from,to){this.type="rg",this.from=from,this.mode=t.BindingMode._s,this.oneTime=0,this.to=to}},t.HydrateAttributeInstruction=class{constructor(res,instructions){this.type="rb",this.instructions=instructions,this.res=res}},t.HydrateElementInstruction=class{constructor(res,instructions,parts){this.type="ra",this.instructions=instructions,this.parts=parts,this.res=res}},t.HydrateTemplateController=class{constructor(def,res,instructions,link){this.type="rc",this.def=def,this.instructions=instructions,this.link=link,this.res=res}},t.InterpolationInstruction=class{constructor(from,to){this.type="rf",this.from=from,this.to=to}},t.IteratorBindingInstruction=class{constructor(from,to){this.type="rk",this.from=from,this.to=to}},t.LetBindingInstruction=class{constructor(from,to){this.type="ri",this.from=from,this.to=to}},t.LetElementInstruction=class{constructor(instructions,toViewModel){this.type="rd",this.instructions=instructions,this.toViewModel=toViewModel}},t.OneTimeBindingInstruction=class{constructor(from,to){this.type="rg",this.from=from,this.mode=t.BindingMode.oneTime,this.oneTime=1,this.to=to}},t.RefBindingInstruction=class{constructor(from){this.type="rj",this.from=from}},t.SetPropertyInstruction=class{constructor(value,to){this.type="re",this.to=to,this.value=value}},t.ToViewBindingInstruction=class{constructor(from,to){this.type="rg",this.from=from,this.mode=t.BindingMode.Ws,this.oneTime=0,this.to=to}},t.TwoWayBindingInstruction=class{constructor(from,to){this.type="rg",this.type="rg",this.from=from,this.mode=t.BindingMode.Gs,this.oneTime=0,this.to=to}},t.AggregateLifecycleTask=AggregateLifecycleTask,t.CompositionCoordinator=CompositionCoordinator,t.ILifecycle=ILifecycle,t.IRenderable=IRenderable,t.IViewFactory=IViewFactory,t.LifecycleTask=LifecycleTask,t.PromiseTask=class{constructor(t,s){this.done=0,this.$e=0,this.no=s,this.Ph=t.then(value=>{if(1!=this.$e)return this.done=1,this.no(value),value})}Oe(){return!this.done}cancel(){this.Oe()&&(this.$e=1)}je(){return this.Ph}},t.instructionRenderer=instructionRenderer,t.ensureExpression=ensureExpression,t.addComponent=addComponent,t.addBinding=addBinding,t.CompiledTemplate=class{constructor(dom,t,s,i){this.dom=dom,this.Dc=t,this.Zo=s,this.qo=i}Vs(s,host,parts,i=t.LifecycleFlags.ti){const n=s.$nodes=this.Zo.Lc();s.$context=this.qo,this.qo.Vs(i|=this.Dc.strategy,s,n.Po(),this.Dc,host,parts)}},t.createRenderContext=createRenderContext,t.IInstructionRenderer=IInstructionRenderer,t.IRenderer=IRenderer,t.IRenderingEngine=IRenderingEngine,t.ITemplateCompiler=ITemplateCompiler,t.ITemplateFactory=ITemplateFactory,Object.defineProperty(t,"Bc",{value:1})});
